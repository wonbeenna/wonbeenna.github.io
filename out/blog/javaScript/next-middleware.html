<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/0e4fe491bf84089c-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/627622453ef56b0d-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/7d8c9b0ca4a64a5a-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/8db47a8bf03b7d2f-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/934c4b7cb736f2a3-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/0da05791a264d82c.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/d2ca7d8f29c2051c.css" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-7f8e37c778ddb15e.js" as="script" fetchPriority="low"/><script src="/_next/static/chunks/fd9d1056-aa1b7ad4013ab4d6.js" async=""></script><script src="/_next/static/chunks/864-63b4fa4ac0454e1a.js" async=""></script><script src="/_next/static/chunks/main-app-a9556013570ce939.js" async=""></script><title>Next.js middleware와 getServerSideProps</title><meta name="description" content="세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록"/><meta property="og:title" content="Next.js middleware와 getServerSideProps"/><meta property="og:description" content="세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록"/><meta property="og:url" content="https://wonbeenna.github.io/javaScript/next-middleware"/><meta property="og:image" content="https://wonbeenna.github.io//assets/postIcon/Nextjs.svg"/><meta property="og:image:width" content="800"/><meta property="og:image:height" content="600"/><meta property="og:image:alt" content="Next.js middleware와 getServerSideProps"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Next.js middleware와 getServerSideProps"/><meta name="twitter:description" content="세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록"/><meta name="twitter:image" content="https://wonbeenna.github.io//assets/postIcon/Nextjs.svg"/><meta name="twitter:image:width" content="800"/><meta name="twitter:image:height" content="600"/><meta name="twitter:image:alt" content="Next.js middleware와 getServerSideProps"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="192x192"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><body class="__className_471caf"><header class="sticky top-0 z-10 mx-auto my-0 h-[56px] border-b-[1px] border-b-gray200 bg-white px-[24px] py-0"><section class="m-auto flex h-full max-w-[970px] items-center justify-between"><div class="flex items-center gap-[20px]"><a href="/"><img alt="logo" loading="lazy" width="60" height="56" decoding="async" data-nimg="1" style="color:transparent" src="/assets/icons/been-logo.svg"/></a><div class="flex items-center gap-[20px]"><a href="/about">About</a></div></div><div class="flex items-center gap-[20px]"><a target="_blank" rel="noopener noreferrer" href="https://github.com/wonbeenna"><img alt="github" loading="lazy" width="30" height="30" decoding="async" data-nimg="1" style="color:transparent" src="/assets/icons/github.svg"/></a><a href="mailto:nwbnwb@naver.com"><img alt="email" loading="lazy" width="34" height="34" decoding="async" data-nimg="1" style="color:transparent" src="/assets/icons/mail.svg"/></a></div></section></header><main class="mx-auto my-0 max-w-[970px] p-[16px]"><div class="prose w-full max-w-none"><div class="border-b-2 border-b-gray500"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">Next.js middleware와 getServerSideProps</h1><h2 class="my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록</h2><p class="text-[12px] text-gray700 md:text-[16px]">2023-02-22</p></div><p>인증방식에는 대표적으로 두가지가 있다.</p><p>제일 많이 사용하는 세션 방식과 토큰 방식</p><ul><li>인증 -&gt; 유저가 누구인지 확인</li><li>인가 -&gt; 유저의 요청에 대한 권한을 확인하고 허가</li></ul><hr/><h3>세션방식</h3><ul><li>로그인 요청 -&gt; 서버에서 세션 key-value로 구분해 정보를 저장</li><li>서버 -&gt; 클라이언트 측으로 http header cookie에 세션 id를 담아 전달</li><li>클라이언트 쪽에서 response값으로 cookie에 저장된 세션을 확인할 수 있는데, 브라우저에 저장</li></ul><p>세션 방식은 HTTP요청이 노출되어도 세션 자체에는 의미있는 값이 없기 때문에 보안상 유리할 수 있다.</p><p>각 사용자마다 고유한 id를 갖고 있기 때문에 매번 회원정보를 확인할 필요가 없다.</p><p>서버에 따로 세션 저장소를 두기 때문에 사용자가 많아지면 서버에 부담이 간다.</p><p>각 브라우저들은 보안상의 이슈로 서버와 프론트간의 도메인이 같아야 쿠키가 전달된다.</p><ul><li><p>프론트 측에서는 Axios 사용시 <code>withCredentials: true</code>설정을 통해 서로 다른 도메인간의 요청에도 credential 정보를 받을 것인지 설정해야 한다.</p></li><li><p>서버 측에서는 응답 헤더의 Access-Control-Allow-Credentials 항목을 true로 설정해야 하고,
응답 헤더의 Access-Control-Allow-Origin의 값을 와일드 카드(&#x27;*&#x27;) 제외하고 설정 되어야 한다.</p></li></ul><hr/><p>우선 localhost와 서버상의 도메인이 달라 proxy 설정을 해줬다.</p><pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// pages/api/[...path].ts</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> NextApiRequest<span class="token punctuation">,</span> NextApiResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;next&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> httpProxyMiddleware <span class="token keyword">from</span> <span class="token string">&quot;next-http-proxy-middleware&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  api<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    externalResolver<span class="token operator">:</span> <span class="token boolean">true</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>req<span class="token operator">:</span> NextApiRequest<span class="token punctuation">,</span> res<span class="token operator">:</span> NextApiResponse<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token function">httpProxyMiddleware</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">        target<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NEXT_PUBLIC_API_URL</span><span class="token punctuation">,</span>
</span><span class="code-line">        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">        pathRewrite<span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">          <span class="token punctuation">{</span>
</span><span class="code-line">            patternStr<span class="token operator">:</span> <span class="token string">&quot;^/api/&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">            replaceStr<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">        cookieDomainRewrite<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token string-property property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre><pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">/** @type {import(&#x27;next&#x27;).NextConfig} */</span>
</span><span class="code-line"><span class="token keyword">const</span> nextConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  swcMinify<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">  reactStrictMode<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">  compiler<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    styledComponents<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">    removeConsole<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token keyword">async</span> <span class="token function">rewrites</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&quot;production&quot;</span>
</span><span class="code-line">      <span class="token operator">?</span> <span class="token punctuation">[</span>
</span><span class="code-line">          <span class="token punctuation">{</span>
</span><span class="code-line">            source<span class="token operator">:</span> <span class="token string">&quot;/api/:path*&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">            destination<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NEXT_PUBLIC_API_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/:path*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">]</span>
</span><span class="code-line">      <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre><hr/><p>위 처럼 설정해 주니 서버에서 보낸 cookie가 localhost 브라우저에 잘 들어왔다.</p><p>여기서 고민했던 부분이 csr환경이 아닌 next의 ssr환경인 프론트측 서버단에서는 유저인증을 어떻게 확인할 것인가 였다.</p><p>우선 로그인 상태와 비로그인 상태에서 접근불가능한 페이지 접근시 리다이렉트를 시키는 방법으로 진행했다.</p><p>Nextjs middleware는 root폴더에 middleware.ts 파일을 만들어 주면 페이지 라우팅 되기 전에 middleware가 자동으로 실행된다.</p><p>Nextjs에서 지원하는 middleware는 들어오는 요청에 따라서 req, res, header를 다시 작성하거나 리디렉션 등을 수정하거나 재작성할 수 있다.</p><pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> NextRequest <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;next/server&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> fetchAuth<span class="token punctuation">,</span> inValidateAuth<span class="token punctuation">,</span> validateAuth <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/lib/validateUser&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> validatedUrl <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">  <span class="token string">&quot;/users/sign-in&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/sign-up/normal&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/sign-up/social&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/sign-up/vendor&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/password/reset&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> inValidateUrl <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;/users/my-page&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">middleware</span><span class="token punctuation">(</span>req<span class="token operator">:</span> NextRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span>nextUrl<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>validatedUrl<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">validateAuth</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>inValidateUrl<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">inValidateAuth</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">fetchAuth</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  matcher<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;/((?!api|_next/static|_next/image|favicon.ico|assets).*)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre><pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> NextRequest<span class="token punctuation">,</span> NextResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;next/server&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">validateUser</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token operator">:</span> NextRequest<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    method<span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    mode<span class="token operator">:</span> <span class="token string">&quot;cors&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    credentials<span class="token operator">:</span> <span class="token string">&quot;same-origin&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">      cookie<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;cookie&quot;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">fetchAuth</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>req<span class="token operator">:</span> NextRequest<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">const</span> res <span class="token operator">=</span> NextResponse<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">validateUser</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            res<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">return</span> res<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            res<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            res<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;user.sid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">            <span class="token keyword">return</span> res<span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Validate Error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre><p>처음에 이런식으로 미들웨어를 구현했다. matcher로 페이지단만 확인했고, 페이지 라우팅시 유저 인증에 성공하면 cookie를 통해 유저정보와 세션을 전달했다.</p><p>또 인증성공시 접근 x, 비인증시 접근 x 한 url을 확인해 리다이렉트 시키도록 했다.</p><p>처음 해봤던 작업이었고, 제대로 구현한지 확신이 들지 않아 코드리뷰를 요청했다.</p><p>middleware를 사용하지 않고 hocs를 사용해 auth를 호출하고, axios config에 headers를 전달하는 방법으로 알려주셨다.</p><pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> GetServerSideProps<span class="token punctuation">,</span> GetServerSidePropsContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;next&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> getAuth <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/models/auth&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> merge <span class="token keyword">from</span> <span class="token string">&quot;lodash/merge&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> validatedUrl <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">  <span class="token string">&quot;/users/sign-in&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/sign-up/normal&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/sign-up/social&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/sign-up/vendor&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/password/reset&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> inValidateUrl <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">  <span class="token string">&quot;/users/my-page&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/my-page/profile&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token string">&quot;/users/my-page/review&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">withAuth</span><span class="token punctuation">(</span>getServerSideProps<span class="token operator">?</span><span class="token operator">:</span> GetServerSideProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>context<span class="token operator">:</span> GetServerSidePropsContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> url <span class="token operator">=</span> context<span class="token punctuation">.</span>req<span class="token punctuation">.</span>url <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAuth</span><span class="token punctuation">(</span><span class="token punctuation">{</span> headers<span class="token operator">:</span> context<span class="token punctuation">.</span>req<span class="token punctuation">.</span>headers <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      user <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>inValidateUrl<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">        redirect<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">          permanent<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">          destination<span class="token operator">:</span> <span class="token string">&quot;/users/sign-in&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">await</span> getServerSideProps<span class="token operator">?.</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> <span class="token punctuation">{</span> props<span class="token operator">:</span> <span class="token punctuation">{</span> user <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre><p>middleware는 nextjs에서 서버도 같이 구성해 사용하면 좋을거라고 조언을 주셨다.</p><pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// page/*</span>
</span><span class="code-line"><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> getServerSideProps <span class="token operator">=</span> <span class="token function">withAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
</span></code></pre></div></main><footer class="flex items-center justify-center pb-[16px] text-center text-[14px] text-gray600">Copyright © Been.</footer><script src="/_next/static/chunks/webpack-7f8e37c778ddb15e.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/0e4fe491bf84089c-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/627622453ef56b0d-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/media/7d8c9b0ca4a64a5a-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/media/8db47a8bf03b7d2f-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n5:HL[\"/_next/static/media/934c4b7cb736f2a3-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n6:HL[\"/"])</script><script>self.__next_f.push([1,"_next/static/css/0da05791a264d82c.css\",\"style\"]\n0:\"$L7\"\n"])</script><script>self.__next_f.push([1,"8:HL[\"/_next/static/css/d2ca7d8f29c2051c.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"9:I{\"id\":6054,\"chunks\":[\"272:static/chunks/webpack-7f8e37c778ddb15e.js\",\"971:static/chunks/fd9d1056-aa1b7ad4013ab4d6.js\",\"864:static/chunks/864-63b4fa4ac0454e1a.js\"],\"name\":\"\",\"async\":false}\nb:I{\"id\":1729,\"chunks\":[\"272:static/chunks/webpack-7f8e37c778ddb15e.js\",\"971:static/chunks/fd9d1056-aa1b7ad4013ab4d6.js\",\"864:static/chunks/864-63b4fa4ac0454e1a.js\"],\"name\":\"\",\"async\":false}\nc:I{\"id\":4724,\"chunks\":[\"964:static/chunks/964-25e165a2fc7e6293.js\",\"724:static/chunks/724-31617d2d81601bd9.js\",\"254:static/chunks"])</script><script>self.__next_f.push([1,"/app/blog/[category]/page-7e34afc005822bdb.js\"],\"name\":\"\",\"async\":false}\nd:I{\"id\":6964,\"chunks\":[\"964:static/chunks/964-25e165a2fc7e6293.js\",\"724:static/chunks/724-31617d2d81601bd9.js\",\"254:static/chunks/app/blog/[category]/page-7e34afc005822bdb.js\"],\"name\":\"Image\",\"async\":false}\ne:I{\"id\":1443,\"chunks\":[\"272:static/chunks/webpack-7f8e37c778ddb15e.js\",\"971:static/chunks/fd9d1056-aa1b7ad4013ab4d6.js\",\"864:static/chunks/864-63b4fa4ac0454e1a.js\"],\"name\":\"\",\"async\":false}\nf:I{\"id\":8639,\"chunks\":[\"272:static/chun"])</script><script>self.__next_f.push([1,"ks/webpack-7f8e37c778ddb15e.js\",\"971:static/chunks/fd9d1056-aa1b7ad4013ab4d6.js\",\"864:static/chunks/864-63b4fa4ac0454e1a.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"7:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0da05791a264d82c.css\",\"precedence\":\"next\"}]],[\"$\",\"$L9\",null,{\"buildId\":\"asWf7pWl7GLV53uWMN65v\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/javaScript/next-middleware\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"category\",\"javaScript\",\"d\"],{\"children\":[[\"slug\",\"next-middleware\",\"d\"],{\"children\":[\"__PAGE__?{\\\"category\\\":\\\"javaScript\\\",\\\"slug\\\":\\\"next-middleware\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$La\"],\"globalErrorComponent\":\"$b\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[null,[\"$\",\"body\",null,{\"suppressHydrationWarning\":true,\"className\":\"__className_471caf\",\"children\":[[\"$\",\"header\",null,{\"className\":\"sticky top-0 z-10 mx-auto my-0 h-[56px] border-b-[1px] border-b-gray200 bg-white px-[24px] py-0\",\"children\":[\"$\",\"section\",null,{\"className\":\"m-auto flex h-full max-w-[970px] items-center justify-between\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-[20px]\",\"children\":[[\"$\",\"$Lc\",null,{\"href\":\"/\",\"children\":[\"$\",\"$Ld\",null,{\"src\":\"/assets/icons/been-logo.svg\",\"width\":60,\"height\":56,\"alt\":\"logo\"}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-[20px]\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"/about\",\"children\":\"About\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-[20px]\",\"children\":[[\"$\",\"$Lc\",null,{\"href\":\"https://github.com/wonbeenna\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":[\"$\",\"$Ld\",null,{\"src\":\"/assets/icons/github.svg\",\"width\":30,\"height\":30,\"alt\":\"github\"}]}],[\"$\",\"$Lc\",null,{\"href\":\"mailto:nwbnwb@naver.com\",\"children\":[\"$\",\"$Ld\",null,{\"src\":\"/assets/icons/mail.svg\",\"width\":34,\"height\":34,\"alt\":\"email\"}]}]]}]]}]}],[\"$\",\"main\",null,{\"className\":\"mx-auto my-0 max-w-[970px] p-[16px]\",\"children\":[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",[\"category\",\"javaScript\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",[\"category\",\"javaScript\",\"d\"],\"children\",[\"slug\",\"next-middleware\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$L10\",\"$L11\",null],\"segment\":\"__PAGE__?{\\\"category\\\":\\\"javaScript\\\",\\\"slug\\\":\\\"next-middleware\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/d2ca7d8f29c2051c.css\",\"precedence\":\"next\"}]]}],\"segment\":[\"slug\",\"next-middleware\",\"d\"]},\"styles\":[]}],\"segment\":[\"category\",\"javaScript\",\"d\"]},\"styles\":[]}],\"segment\":\"blog\"},\"styles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"flex items-center justify-center pb-[16px] text-center text-[14px] text-gray600\",\"children\":\"Copyright © Been.\"}]]}]]}],null]}]]\n"])</script><script>self.__next_f.push([1,"12:I{\"id\":2266,\"chunks\":[\"964:static/chunks/964-25e165a2fc7e6293.js\",\"819:static/chunks/app/blog/[category]/[slug]/page-54a0c01a0f1cf06c.js\"],\"name\":\"\",\"async\":false}\n13:Te9d0,"])</script><script>self.__next_f.push([1,"var l=Object.defineProperty,u=Object.defineProperties;var i=Object.getOwnPropertyDescriptors;var t=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;var c=(n,e,s)=\u003ee in n?l(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,a=(n,e)=\u003e{for(var s in e||(e={}))o.call(e,s)\u0026\u0026c(n,s,e[s]);if(t)for(var s of t(e))m.call(e,s)\u0026\u0026c(n,s,e[s]);return n},N=(n,e)=\u003eu(n,i(e));var r=(n,e)=\u003e{var s={};for(var p in n)o.call(n,p)\u0026\u0026e.indexOf(p)\u003c0\u0026\u0026(s[p]=n[p]);if(n!=null\u0026\u0026t)for(var p of t(n))e.indexOf(p)\u003c0\u0026\u0026m.call(n,p)\u0026\u0026(s[p]=n[p]);return s};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var p=s,{components:n}=p,e=r(p,[\"components\"]);return mdx(MDXLayout,N(a(a({},layoutProps),e),{components:n,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"\\uC778\\uC99D\\uBC29\\uC2DD\\uC5D0\\uB294 \\uB300\\uD45C\\uC801\\uC73C\\uB85C \\uB450\\uAC00\\uC9C0\\uAC00 \\uC788\\uB2E4.\"),mdx(\"p\",null,\"\\uC81C\\uC77C \\uB9CE\\uC774 \\uC0AC\\uC6A9\\uD558\\uB294 \\uC138\\uC158 \\uBC29\\uC2DD\\uACFC \\uD1A0\\uD070 \\uBC29\\uC2DD\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uC778\\uC99D -\u003e \\uC720\\uC800\\uAC00 \\uB204\\uAD6C\\uC778\\uC9C0 \\uD655\\uC778\"),mdx(\"li\",{parentName:\"ul\"},\"\\uC778\\uAC00 -\u003e \\uC720\\uC800\\uC758 \\uC694\\uCCAD\\uC5D0 \\uB300\\uD55C \\uAD8C\\uD55C\\uC744 \\uD655\\uC778\\uD558\\uACE0 \\uD5C8\\uAC00\")),mdx(\"hr\",null),mdx(\"h3\",null,\"\\uC138\\uC158\\uBC29\\uC2DD\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"\\uB85C\\uADF8\\uC778 \\uC694\\uCCAD -\u003e \\uC11C\\uBC84\\uC5D0\\uC11C \\uC138\\uC158 key-value\\uB85C \\uAD6C\\uBD84\\uD574 \\uC815\\uBCF4\\uB97C \\uC800\\uC7A5\"),mdx(\"li\",{parentName:\"ul\"},\"\\uC11C\\uBC84 -\u003e \\uD074\\uB77C\\uC774\\uC5B8\\uD2B8 \\uCE21\\uC73C\\uB85C http header cookie\\uC5D0 \\uC138\\uC158 id\\uB97C \\uB2F4\\uC544 \\uC804\\uB2EC\"),mdx(\"li\",{parentName:\"ul\"},\"\\uD074\\uB77C\\uC774\\uC5B8\\uD2B8 \\uCABD\\uC5D0\\uC11C response\\uAC12\\uC73C\\uB85C cookie\\uC5D0 \\uC800\\uC7A5\\uB41C \\uC138\\uC158\\uC744 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB294\\uB370, \\uBE0C\\uB77C\\uC6B0\\uC800\\uC5D0 \\uC800\\uC7A5\")),mdx(\"p\",null,\"\\uC138\\uC158 \\uBC29\\uC2DD\\uC740 HTTP\\uC694\\uCCAD\\uC774 \\uB178\\uCD9C\\uB418\\uC5B4\\uB3C4 \\uC138\\uC158 \\uC790\\uCCB4\\uC5D0\\uB294 \\uC758\\uBBF8\\uC788\\uB294 \\uAC12\\uC774 \\uC5C6\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uBCF4\\uC548\\uC0C1 \\uC720\\uB9AC\\uD560 \\uC218 \\uC788\\uB2E4.\"),mdx(\"p\",null,\"\\uAC01 \\uC0AC\\uC6A9\\uC790\\uB9C8\\uB2E4 \\uACE0\\uC720\\uD55C id\\uB97C \\uAC16\\uACE0 \\uC788\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uB9E4\\uBC88 \\uD68C\\uC6D0\\uC815\\uBCF4\\uB97C \\uD655\\uC778\\uD560 \\uD544\\uC694\\uAC00 \\uC5C6\\uB2E4.\"),mdx(\"p\",null,\"\\uC11C\\uBC84\\uC5D0 \\uB530\\uB85C \\uC138\\uC158 \\uC800\\uC7A5\\uC18C\\uB97C \\uB450\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC0AC\\uC6A9\\uC790\\uAC00 \\uB9CE\\uC544\\uC9C0\\uBA74 \\uC11C\\uBC84\\uC5D0 \\uBD80\\uB2F4\\uC774 \\uAC04\\uB2E4.\"),mdx(\"p\",null,\"\\uAC01 \\uBE0C\\uB77C\\uC6B0\\uC800\\uB4E4\\uC740 \\uBCF4\\uC548\\uC0C1\\uC758 \\uC774\\uC288\\uB85C \\uC11C\\uBC84\\uC640 \\uD504\\uB860\\uD2B8\\uAC04\\uC758 \\uB3C4\\uBA54\\uC778\\uC774 \\uAC19\\uC544\\uC57C \\uCFE0\\uD0A4\\uAC00 \\uC804\\uB2EC\\uB41C\\uB2E4.\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"\\uD504\\uB860\\uD2B8 \\uCE21\\uC5D0\\uC11C\\uB294 Axios \\uC0AC\\uC6A9\\uC2DC \",mdx(\"inlineCode\",{parentName:\"p\"},\"withCredentials: true\"),\"\\uC124\\uC815\\uC744 \\uD1B5\\uD574 \\uC11C\\uB85C \\uB2E4\\uB978 \\uB3C4\\uBA54\\uC778\\uAC04\\uC758 \\uC694\\uCCAD\\uC5D0\\uB3C4 credential \\uC815\\uBCF4\\uB97C \\uBC1B\\uC744 \\uAC83\\uC778\\uC9C0 \\uC124\\uC815\\uD574\\uC57C \\uD55C\\uB2E4.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},`\\uC11C\\uBC84 \\uCE21\\uC5D0\\uC11C\\uB294 \\uC751\\uB2F5 \\uD5E4\\uB354\\uC758 Access-Control-Allow-Credentials \\uD56D\\uBAA9\\uC744 true\\uB85C \\uC124\\uC815\\uD574\\uC57C \\uD558\\uACE0,\n\\uC751\\uB2F5 \\uD5E4\\uB354\\uC758 Access-Control-Allow-Origin\\uC758 \\uAC12\\uC744 \\uC640\\uC77C\\uB4DC \\uCE74\\uB4DC('*') \\uC81C\\uC678\\uD558\\uACE0 \\uC124\\uC815 \\uB418\\uC5B4\\uC57C \\uD55C\\uB2E4.`))),mdx(\"hr\",null),mdx(\"p\",null,\"\\uC6B0\\uC120 localhost\\uC640 \\uC11C\\uBC84\\uC0C1\\uC758 \\uB3C4\\uBA54\\uC778\\uC774 \\uB2EC\\uB77C proxy \\uC124\\uC815\\uC744 \\uD574\\uC92C\\uB2E4.\"),mdx(\"pre\",a({},{className:\"language-ts\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-ts code-highlight\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token comment\"}),\"// pages/api/[...path].ts\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"type\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" NextApiRequest\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" NextApiResponse \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"next\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" httpProxyMiddleware \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"next-http-proxy-middleware\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" config \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  api\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    externalResolver\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token boolean\"}),\"true\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"default\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" NextApiRequest\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" res\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" NextApiResponse\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"httpProxyMiddleware\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" res\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        target\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" process\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"env\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token constant\"}),\"NEXT_PUBLIC_API_URL\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        changeOrigin\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token boolean\"}),\"true\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        pathRewrite\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"          \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            patternStr\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"^/api/\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            replaceStr\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"          \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        cookieDomainRewrite\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"          \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string-property property\"}),'\"*\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"localhost\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`))),mdx(\"pre\",a({},{className:\"language-ts\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-ts code-highlight\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token comment\"}),\"/** @type {import('next').NextConfig} */\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" nextConfig \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  swcMinify\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token boolean\"}),\"true\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  reactStrictMode\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token boolean\"}),\"true\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  compiler\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    styledComponents\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token boolean\"}),\"true\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    removeConsole\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" process\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"env\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token constant\"}),\"NODE_ENV\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"===\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"production\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"async\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"rewrites\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" process\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"env\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token constant\"}),\"NODE_ENV\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"===\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"production\"'),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"?\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"          \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            source\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/api/:path*\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            destination\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token template-string\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token template-punctuation string\"}),\"`\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation-punctuation punctuation\"}),\"${\"),\"process\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"env\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token constant\"}),\"NEXT_PUBLIC_API_URL\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation-punctuation punctuation\"}),\"}\")),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),\"/:path*\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token template-punctuation string\"}),\"`\")),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"          \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"...\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`))),mdx(\"hr\",null),mdx(\"p\",null,\"\\uC704 \\uCC98\\uB7FC \\uC124\\uC815\\uD574 \\uC8FC\\uB2C8 \\uC11C\\uBC84\\uC5D0\\uC11C \\uBCF4\\uB0B8 cookie\\uAC00 localhost \\uBE0C\\uB77C\\uC6B0\\uC800\\uC5D0 \\uC798 \\uB4E4\\uC5B4\\uC654\\uB2E4.\"),mdx(\"p\",null,\"\\uC5EC\\uAE30\\uC11C \\uACE0\\uBBFC\\uD588\\uB358 \\uBD80\\uBD84\\uC774 csr\\uD658\\uACBD\\uC774 \\uC544\\uB2CC next\\uC758 ssr\\uD658\\uACBD\\uC778 \\uD504\\uB860\\uD2B8\\uCE21 \\uC11C\\uBC84\\uB2E8\\uC5D0\\uC11C\\uB294 \\uC720\\uC800\\uC778\\uC99D\\uC744 \\uC5B4\\uB5BB\\uAC8C \\uD655\\uC778\\uD560 \\uAC83\\uC778\\uAC00 \\uC600\\uB2E4.\"),mdx(\"p\",null,\"\\uC6B0\\uC120 \\uB85C\\uADF8\\uC778 \\uC0C1\\uD0DC\\uC640 \\uBE44\\uB85C\\uADF8\\uC778 \\uC0C1\\uD0DC\\uC5D0\\uC11C \\uC811\\uADFC\\uBD88\\uAC00\\uB2A5\\uD55C \\uD398\\uC774\\uC9C0 \\uC811\\uADFC\\uC2DC \\uB9AC\\uB2E4\\uC774\\uB809\\uD2B8\\uB97C \\uC2DC\\uD0A4\\uB294 \\uBC29\\uBC95\\uC73C\\uB85C \\uC9C4\\uD589\\uD588\\uB2E4.\"),mdx(\"p\",null,\"Nextjs middleware\\uB294 root\\uD3F4\\uB354\\uC5D0 middleware.ts \\uD30C\\uC77C\\uC744 \\uB9CC\\uB4E4\\uC5B4 \\uC8FC\\uBA74 \\uD398\\uC774\\uC9C0 \\uB77C\\uC6B0\\uD305 \\uB418\\uAE30 \\uC804\\uC5D0 middleware\\uAC00 \\uC790\\uB3D9\\uC73C\\uB85C \\uC2E4\\uD589\\uB41C\\uB2E4.\"),mdx(\"p\",null,\"Nextjs\\uC5D0\\uC11C \\uC9C0\\uC6D0\\uD558\\uB294 middleware\\uB294 \\uB4E4\\uC5B4\\uC624\\uB294 \\uC694\\uCCAD\\uC5D0 \\uB530\\uB77C\\uC11C req, res, header\\uB97C \\uB2E4\\uC2DC \\uC791\\uC131\\uD558\\uAC70\\uB098 \\uB9AC\\uB514\\uB809\\uC158 \\uB4F1\\uC744 \\uC218\\uC815\\uD558\\uAC70\\uB098 \\uC7AC\\uC791\\uC131\\uD560 \\uC218 \\uC788\\uB2E4.\"),mdx(\"pre\",a({},{className:\"language-ts\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-ts code-highlight\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"type\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" NextRequest \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"next/server\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" fetchAuth\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" inValidateAuth\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" validateAuth \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"@/lib/validateUser\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" validatedUrl \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-in\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-up/normal\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-up/social\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-up/vendor\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/password/reset\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" inValidateUrl \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/my-page\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"async\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"function\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"middleware\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" NextRequest\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" url \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"nextUrl\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"if\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"validatedUrl\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"includes\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"url\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"pathname\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"await\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"validateAuth\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"if\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"inValidateUrl\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"includes\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"url\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"pathname\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"await\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"inValidateAuth\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"await\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"fetchAuth\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" config \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  matcher\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/((?!api|_next/static|_next/image|favicon.ico|assets).*)\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`))),mdx(\"pre\",a({},{className:\"language-ts\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-ts code-highlight\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" NextRequest\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" NextResponse \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"next/server\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function-variable function\"}),\"validateUser\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" NextRequest\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"fetch\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"url\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    method\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"get\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    mode\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"cors\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    credentials\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"same-origin\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    headers\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string-property property\"}),'\"Content-Type\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"application/json\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      cookie\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token template-string\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token template-punctuation string\"}),\"`\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation-punctuation punctuation\"}),\"${\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"headers\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"get\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"cookie\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token interpolation-punctuation punctuation\"}),\"}\")),mdx(\"span\",a({parentName:\"span\"},{className:\"token template-punctuation string\"}),\"`\")),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"...\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function-variable function\"}),\"fetchAuth\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"async\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" NextRequest\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\u003e\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"try\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" res \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" NextResponse\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"next\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" response \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"await\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"validateUser\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" data \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"await\"),\" response\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"json\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"if\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"response\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"ok\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            res\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"cookies\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"set\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"user\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token constant\"}),\"JSON\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"stringify\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"data\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" res\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"if\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"!\"),\"response\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"ok\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            res\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"cookies\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"delete\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"user\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            res\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"cookies\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"delete\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"user.sid\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"            \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" res\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"catch\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"e\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"throw\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"new\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token class-name\"}),\"Error\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"Validate Error\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`))),mdx(\"p\",null,\"\\uCC98\\uC74C\\uC5D0 \\uC774\\uB7F0\\uC2DD\\uC73C\\uB85C \\uBBF8\\uB4E4\\uC6E8\\uC5B4\\uB97C \\uAD6C\\uD604\\uD588\\uB2E4. matcher\\uB85C \\uD398\\uC774\\uC9C0\\uB2E8\\uB9CC \\uD655\\uC778\\uD588\\uACE0, \\uD398\\uC774\\uC9C0 \\uB77C\\uC6B0\\uD305\\uC2DC \\uC720\\uC800 \\uC778\\uC99D\\uC5D0 \\uC131\\uACF5\\uD558\\uBA74 cookie\\uB97C \\uD1B5\\uD574 \\uC720\\uC800\\uC815\\uBCF4\\uC640 \\uC138\\uC158\\uC744 \\uC804\\uB2EC\\uD588\\uB2E4.\"),mdx(\"p\",null,\"\\uB610 \\uC778\\uC99D\\uC131\\uACF5\\uC2DC \\uC811\\uADFC x, \\uBE44\\uC778\\uC99D\\uC2DC \\uC811\\uADFC x \\uD55C url\\uC744 \\uD655\\uC778\\uD574 \\uB9AC\\uB2E4\\uC774\\uB809\\uD2B8 \\uC2DC\\uD0A4\\uB3C4\\uB85D \\uD588\\uB2E4.\"),mdx(\"p\",null,\"\\uCC98\\uC74C \\uD574\\uBD24\\uB358 \\uC791\\uC5C5\\uC774\\uC5C8\\uACE0, \\uC81C\\uB300\\uB85C \\uAD6C\\uD604\\uD55C\\uC9C0 \\uD655\\uC2E0\\uC774 \\uB4E4\\uC9C0 \\uC54A\\uC544 \\uCF54\\uB4DC\\uB9AC\\uBDF0\\uB97C \\uC694\\uCCAD\\uD588\\uB2E4.\"),mdx(\"p\",null,\"middleware\\uB97C \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uACE0 hocs\\uB97C \\uC0AC\\uC6A9\\uD574 auth\\uB97C \\uD638\\uCD9C\\uD558\\uACE0, axios config\\uC5D0 headers\\uB97C \\uC804\\uB2EC\\uD558\\uB294 \\uBC29\\uBC95\\uC73C\\uB85C \\uC54C\\uB824\\uC8FC\\uC168\\uB2E4.\"),mdx(\"pre\",a({},{className:\"language-ts\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-ts code-highlight\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" React \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"react\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" GetServerSideProps\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" GetServerSidePropsContext \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"next\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" getAuth \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"@/models/auth\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"import\"),\" merge \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"from\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"lodash/merge\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" validatedUrl \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-in\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-up/normal\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-up/social\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-up/vendor\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/password/reset\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" inValidateUrl \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"[\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/my-page\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/my-page/profile\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/my-page/review\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"default\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"function\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"withAuth\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"getServerSideProps\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"?\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" GetServerSideProps\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"async\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"function\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"context\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" GetServerSidePropsContext\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" url \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" context\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"url \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"as\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token builtin\"}),\"string\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"let\"),\" user \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"null\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"try\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" res \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"await\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"getAuth\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" headers\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" context\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"req\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"headers \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      user \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" res\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"data\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"catch\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"e\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"if\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"inValidateUrl\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"includes\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"url\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"\u0026\u0026\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"!\"),\"user\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        redirect\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"          permanent\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token boolean\"}),\"false\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"          destination\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token string\"}),'\"/users/sign-in\"'),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"        \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"      \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"...\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" ret \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"await\"),\" getServerSideProps\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"?.\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"context\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"    \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"return\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"merge\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),\"ret\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" props\",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),\" user \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"  \",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`))),mdx(\"p\",null,\"middleware\\uB294 nextjs\\uC5D0\\uC11C \\uC11C\\uBC84\\uB3C4 \\uAC19\\uC774 \\uAD6C\\uC131\\uD574 \\uC0AC\\uC6A9\\uD558\\uBA74 \\uC88B\\uC744\\uAC70\\uB77C\\uACE0 \\uC870\\uC5B8\\uC744 \\uC8FC\\uC168\\uB2E4.\"),mdx(\"pre\",a({},{className:\"language-ts\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-ts code-highlight\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"token comment\"}),\"// page/*\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"...\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"export\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token keyword\"}),\"const\"),\" getServerSideProps \",mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"token function\"}),\"withAuth\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\";\"),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),`\n`),mdx(\"span\",a({parentName:\"code\"},{className:\"code-line\"}),\"\",mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token operator\"}),\"...\"),mdx(\"span\",a({parentName:\"span\"},{className:\"token punctuation\"}),\"}\"),`\n`))))}MDXContent.isMDXComponent=!0;\n"])</script><script>self.__next_f.push([1,"11:[\"$\",\"div\",null,{\"className\":\"prose w-full max-w-none\",\"children\":[[\"$\",\"div\",null,{\"className\":\"border-b-2 border-b-gray500\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]\",\"children\":\"Next.js middleware와 getServerSideProps\"}],[\"$\",\"h2\",null,{\"className\":\"my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]\",\"children\":\"세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록\"}],[\"$\",\"p\",null,{\"className\":\"text-[12px] text-gray700 md:text-[16px]\",\"children\":\"2023-02-22\"}]]}],[\"$\",\"$L12\",null,{\"compiledSource\":\"$13\",\"scope\":{\"title\":\"Next.js middleware와 getServerSideProps\",\"date\":\"$D2023-02-22T00:00:00.000Z\",\"description\":\"세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/Nextjs.svg\"}}]]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Next.js middleware와 getServerSideProps\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"Next.js middleware와 getServerSideProps\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:url\",\"content\":\"https://wonbeenna.github.io/javaScript/next-middleware\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image\",\"content\":\"https://wonbeenna.github.io//assets/postIcon/Nextjs.svg\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image:width\",\"content\":\"800\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image:height\",\"content\":\"600\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:image:alt\",\"content\":\"Next.js middleware와 getServerSideProps\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:title\",\"content\":\"Next.js middleware와 getServerSideProps\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:description\",\"content\":\"세션방식의 로그인 인증, middleware와 getServerSideProps를 사용해 구현한 기록\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:image\",\"content\":\"https://wonbeenna.github.io//assets/postIcon/Nextjs.svg\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:image:width\",\"content\":\"800\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:image:height\",\"content\":\"600\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:image:alt\",\"content\":\"Next.js middleware와 getServerSideProps\"}],[\"$\",\"link\",\"18\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"192x192\"}],[\"$\",\"meta\",\"19\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"10:null\n"])</script></body></html>