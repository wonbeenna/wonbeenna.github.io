<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/0e4fe491bf84089c-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/627622453ef56b0d-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/7d8c9b0ca4a64a5a-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/8db47a8bf03b7d2f-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/934c4b7cb736f2a3-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/bee2c35e5d2aa945.css" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-5497ae65bf9d345f.js" as="script" fetchPriority="low"/><script src="/_next/static/chunks/fd9d1056-23f6e37ad1d1612c.js" async=""></script><script src="/_next/static/chunks/864-8d9b6481be2de97f.js" async=""></script><script src="/_next/static/chunks/main-app-a9556013570ce939.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-LFDRQZPCBN" as="script"/><title>Been blog - 3</title><meta name="description" content="Been dev-note"/><meta name="google-site-verification" content="BirkRt7C7FYMLW96RbXad2EtPdcl0-_ti9xCRkCHa5U"/><meta name="naver-site-verification" content="58945b2bbe2fe86252fa8c7b204b40f6019920e9"/><meta property="og:title" content="Been blog - 3"/><meta property="og:description" content="Been dev-note - 3"/><meta property="og:url" content="https://wonbeenna.github.io/page/3"/><meta property="og:site_name" content="Been blog"/><meta property="og:image" content="https://wonbeenna.github.io/favicon.png"/><meta property="og:image:width" content="800"/><meta property="og:image:height" content="600"/><meta property="og:image:alt" content="Been blog"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Been blog - 3"/><meta name="twitter:description" content="Been dev-note - 3"/><meta name="twitter:image" content="https://wonbeenna.github.io/favicon.png"/><meta name="twitter:image:width" content="800"/><meta name="twitter:image:height" content="600"/><meta name="twitter:image:alt" content="Been blog"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="192x192"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" noModule=""></script></head><body class="__className_471caf"><header class="sticky top-0 z-10 mx-auto my-0 h-[56px] border-b-[1px] border-b-gray200 bg-white px-[24px] py-0"><section class="m-auto flex h-full max-w-[970px] items-center justify-between"><div class="flex items-center gap-[20px]"><a href="/"><img alt="logo" loading="lazy" width="60" height="56" decoding="async" data-nimg="1" style="color:transparent" src="/assets/icons/been-logo.svg"/></a><div class="flex items-center gap-[20px]"><a href="/about">About</a></div></div><div class="flex items-center gap-[20px]"><a target="_blank" rel="noopener noreferrer" href="https://github.com/wonbeenna"><img alt="github" loading="lazy" width="30" height="30" decoding="async" data-nimg="1" style="color:transparent" src="/assets/icons/github.svg"/></a><a href="mailto:nwbnwb@naver.com"><img alt="email" loading="lazy" width="34" height="34" decoding="async" data-nimg="1" style="color:transparent" src="/assets/icons/mail.svg"/></a></div></section></header><main class="mx-auto my-0 max-w-[970px] p-[16px]"><section class="flex flex-col-reverse md:relative md:flex-row"><div class="flex flex-1 flex-col"><ol class="relative mx-0 my-[20px] flex w-full  flex-col gap-[40px] p-0"><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/til/study"><img alt="6주간 스터디하며 배운것들" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/til.webp"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">6주간 스터디하며 배운것들</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">6주간 진행한 스터디에서 얻은 것들</p><span class="text-gray700">2022-10-21</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/storybook"><img alt="Storybook 써보기" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/storybook.png"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">Storybook 써보기</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">스터디 하면서 처음 써본 Storybook</p><span class="text-gray700">2022-10-11</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/next-styled-component"><img alt="Next.js styled-component 적용 문제에 대해(_document.tsx)" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/Nextjs.svg"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">Next.js styled-component 적용 문제에 대해(_document.tsx)</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">next.js와 styled-component 사용시 발생한 에러</p><span class="text-gray700">2022-08-22</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/intersectionObserver"><img alt="IntersectionObserver로 데이터 요청해보기" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/logo192.png"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">IntersectionObserver로 데이터 요청해보기</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">IntersectionObserver를 활용해 스크롤 위치에서 데이터 불러오기</p><span class="text-gray700">2022-05-04</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/next-bundle-analyzer"><img alt="next/bundle-analyzer" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/Nextjs.svg"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">next/bundle-analyzer</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">next/bundle-analyzer로 번들 크기 확인하기</p><span class="text-gray700">2022-02-22</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/ref-forwardRef"><img alt="리액트 ref 와 forwardRef (with. react-hook-form)" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/logo192.png"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">리액트 ref 와 forwardRef (with. react-hook-form)</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">react-hook-form 라이브러리와 ref의 동작</p><span class="text-gray700">2022-02-09</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/Speechsynthesis"><img alt="Speechsynthesis &amp; Google TTS" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/logo192.png"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">Speechsynthesis &amp; Google TTS</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">프로젝트 진행하며 경험해본 Speechsynthesis &amp; Google TTS</p><span class="text-gray700">2022-01-22</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/web-optimization-3"><img alt="웹성능 최적화(3)" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/logo192.png"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">웹성능 최적화(3)</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">웹성능 최적화3</p><span class="text-gray700">2022-01-04</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/web-optimization-2"><img alt="웹성능 최적화(2)" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/logo192.png"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">웹성능 최적화(2)</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">웹성능 최적화2</p><span class="text-gray700">2022-01-03</span></div></a></li><li class="mt-[30px] border-b-[1px] border-b-gray300 pb-[50px] md:mt-[50px] md:pb-[70px]"><a class="hover_card flex w-full flex-col items-center justify-between gap-0 md:flex-row md:gap-[40px]" href="/blog/javaScript/web-optimization"><img alt="웹성능 최적화(1)" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[200px] w-[200px] rounded-[14px]" style="color:transparent" src="/assets/postIcon/logo192.png"/><div class="flex min-h-[160px] w-full flex-col items-center justify-center md:min-h-[200px]"><h1 class="my-[12px] overflow-hidden text-ellipsis break-words text-[24px] font-bold text-black md:mt-0 md:text-[34px]">웹성능 최적화(1)</h1><p class="mx-[14px] my-[12px] text-ellipsis break-keep text-[14px] text-gray900 md:text-[18px]">웹성능 최적화1</p><span class="text-gray700">2022-01-01</span></div></a></li></ol><ul class="flex items-center justify-center gap-[10px]"><li class="box-border flex h-[24px] w-[24px] cursor-pointer items-center justify-center text-[16px] ">ᐸ</li><li class="box-border flex h-[24px] w-[24px] cursor-pointer items-center justify-center text-[16px] ">1</li><li class="box-border flex h-[24px] w-[24px] cursor-pointer items-center justify-center text-[16px] ">2</li><li class="box-border flex h-[24px] w-[24px] cursor-pointer items-center justify-center text-[16px] rounded-full bg-primaryGradient03 px-[4px] py-[2px] text-white">3</li><li class="box-border flex h-[24px] w-[24px] cursor-pointer items-center justify-center text-[16px] ">4</li><li class="box-border flex h-[24px] w-[24px] cursor-pointer items-center justify-center text-[16px] ">ᐳ</li></ul></div><ul class="relative top-0 flex h-fit min-w-fit flex-row flex-wrap gap-[20px] py-[20px] pl-0 md:sticky md:top-[100px] md:flex-col md:flex-nowrap md:py-0 md:pl-[30px]"><h2 class="hidden text-[18px] font-bold md:inline">Category</h2><li><a class="text-gray700" href="/blog/javaScript">javaScript (31)</a></li><li><a class="text-gray700" href="/blog/study">study (2)</a></li><li><a class="text-gray700" href="/blog/til">til (1)</a></li></ul></section></main><footer class="flex items-center justify-center pb-[16px] text-center text-[14px] text-gray600">Copyright © Been.</footer><script src="/_next/static/chunks/webpack-5497ae65bf9d345f.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/0e4fe491bf84089c-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/627622453ef56b0d-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/media/7d8c9b0ca4a64a5a-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/media/8db47a8bf03b7d2f-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n5:HL[\"/_next/static/media/934c4b7cb736f2a3-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n6:HL[\"/"])</script><script>self.__next_f.push([1,"_next/static/css/bee2c35e5d2aa945.css\",\"style\"]\n0:\"$L7\"\n"])</script><script>self.__next_f.push([1,"8:I{\"id\":6054,\"chunks\":[\"272:static/chunks/webpack-5497ae65bf9d345f.js\",\"971:static/chunks/fd9d1056-23f6e37ad1d1612c.js\",\"864:static/chunks/864-8d9b6481be2de97f.js\"],\"name\":\"\",\"async\":false}\na:I{\"id\":1729,\"chunks\":[\"272:static/chunks/webpack-5497ae65bf9d345f.js\",\"971:static/chunks/fd9d1056-23f6e37ad1d1612c.js\",\"864:static/chunks/864-8d9b6481be2de97f.js\"],\"name\":\"\",\"async\":false}\nb:I{\"id\":4244,\"chunks\":[\"929:static/chunks/929-b3b28e896e4a9fe7.js\",\"185:static/chunks/app/layout-082a41cb7a9cbffe.js\"],\"name\":\"\","])</script><script>self.__next_f.push([1,"\"async\":false}\nc:I{\"id\":4724,\"chunks\":[\"929:static/chunks/929-b3b28e896e4a9fe7.js\",\"411:static/chunks/app/page/[page]/page-084fd1726e5b064b.js\"],\"name\":\"\",\"async\":false}\nd:I{\"id\":6964,\"chunks\":[\"929:static/chunks/929-b3b28e896e4a9fe7.js\",\"185:static/chunks/app/layout-082a41cb7a9cbffe.js\"],\"name\":\"Image\",\"async\":false}\ne:I{\"id\":1443,\"chunks\":[\"272:static/chunks/webpack-5497ae65bf9d345f.js\",\"971:static/chunks/fd9d1056-23f6e37ad1d1612c.js\",\"864:static/chunks/864-8d9b6481be2de97f.js\"],\"name\":\"\",\"async\":false}\nf"])</script><script>self.__next_f.push([1,":I{\"id\":8639,\"chunks\":[\"272:static/chunks/webpack-5497ae65bf9d345f.js\",\"971:static/chunks/fd9d1056-23f6e37ad1d1612c.js\",\"864:static/chunks/864-8d9b6481be2de97f.js\"],\"name\":\"\",\"async\":false}\n11:I{\"id\":7259,\"chunks\":[\"929:static/chunks/929-b3b28e896e4a9fe7.js\",\"411:static/chunks/app/page/[page]/page-084fd1726e5b064b.js\"],\"name\":\"\",\"async\":false}\n12:Tfe7,"])</script><script>self.__next_f.push([1,"\n### 1\\. Utility Type\n\n```typescript\n  Partial\u003cT\u003e\n```\n\n\\- T의 모든 프로퍼티를 선택적으로 만드는 타입\n\n```typescript\ninterface User {\n  name: string;\n  age: number;\n}\n\nfunction updateUser(user: User, fieldsToUpdate: Partial\u003cUser\u003e) {\n  return { ...user, ...fieldsToUpdate };\n}\n\nconst user1 = {\n  name: \"been\",\n  age: 30,\n};\n\nconst user2 = updateUser(user1, {\n  age: 32,\n});\n```\n\n---\n\n```typescript\n  Readonly\u003cT\u003e\n```\n\nT의 모든 프로퍼티를 읽기 전용으로 구성, 생성된 타입의 프로퍼티는 재할당 할 수 없다.\n\n---\n\n```typescript\n  Record\u003cK,T\u003e\n```\n\n타입 T의 프로퍼티의 집합 K로 타입을 구성한다.\n\n주로 다른 타입에 매핑시키는데 사용\n\n```typescript\ninterface PageInfo {\n  title: string;\n}\n\ntype Page = \"home\" | \"about\" | \"contact\";\n\nconst x: Record\u003cPage, PageInfo\u003e = {\n  about: { title: \"about\" },\n  contact: { title: \"contact\" },\n  home: { title: \"home\" },\n};\n```\n\n---\n\n```typescript\n  Pick\u003cT,K\u003e\n```\n\nT에서 K의 집합을 선택해 타입을 구성\n\n```typescript\n  Omit\u003cT,K\u003e\n```\n\nT에서 모든 프로퍼티를 가져온 다음 K를 제거한 타입을 구성\n\n---\n\n```typescript\n  NonNullable\u003cT\u003e\n```\n\nT에서 null과 undefined를 제외한 타입을 구성\n\n---\n\n출처 : [https://typescript-kr.github.io/pages/utility-types.html](https://typescript-kr.github.io/pages/utility-types.html)\n\n---\n\n### 2\\. Storybook 작성\n\n[https://been.tistory.com/58](https://been.tistory.com/58)\n\n---\n\n### 3\\. npm 패키지 배포\n\n[https://www.npmjs.com/package/jci-moyeo-design-system](https://www.npmjs.com/package/jci-moyeo-design-system)\n\n\n---\n\n### 4\\. aria, role\n\n\u003e 웹 접근성(web accessibility)은 장애를 가진 사람과 장애를 가지지 않은 사람 모두가 웹사이트를 이용할 수 있게 하는 방식을 가리킨다. 사이트가 올바르게 설계되어 개발되고 편집되어 있을 때 모든 사용자들은 정보와 기능에 동등하게 접근할 수 있다.\n\n\u003e 웹 표준은 월드 와이드 웹의 측면을 서술하고 정의하는 공식 표준이나 다른 기술 규격을 가리키는 일반적인 용어이다. 최근에 이 용어는 웹 사이트를 작성하는 데 중요도가 높아지고 있으며 웹 디자인, 개발과 관계가 있다.\n\n```typescript\nrole=\"form\"\n\u003cform\u003e과 동일하게 사용\n```\n\n\n```typescript\nrole=\"search\"\n검색 역할을 담당\n```\n\n```typescript\nrole=\"button\"\n스크린리더에 버튼임을 알려주지만 버튼기능을 제공하지는 않기 때문에 \u003cbutton\u003e이나 \u003cinput type='button'\u003e을 사용하는게 좋다.\n```\n\n\n```typescript\nrole =\"tablist\"\n**탭메뉴 등의 리스트임을 사용자에게 전달한다.\n```\n\n\n```typescript\nrole=\"tab\"\n보조기기가 탭으로 인식\naria-required를 true로 지정해 해당요소가 필수적으로 입력되어야 함을 나타냄\n```\n\n```html\n\u003cinput {...} aria-required=\"true\"\u003e\n```\n\n-   추가설명 속성 : div #reference의 내용을 input의 추가설명으로 사용\n\n```html\n\u003cinput type=\"text\" aria-describedby=\"reference\"\u003e\n\u003cdiv id=\"reference\"\u003e추가설명\u003c/div\u003e\n```\n\nex) \"이메일을 입력하세요.\" 라는 추가적인 설명\n\n-   aria-label로 어떤 요소인지 라벨링할 수 있다.\n\n```html\n\u003cdiv role=\"group\" aria-label=\"레이블\"\u003e\n```\n\n-   유효한지 아닌지 구분\n\n```html\n\u003cinput type=\"text\" aria-invalid=\"true\"\u003e\n```\n\n-   버튼 클릭상태와 비클릭상태\n\n```html\n\u003cbutton aria-pressed=\"true\"\u003e\n```\n\n**1) 태그와 중복되지 않게 사용한다.**\n\n```html\n\u003cbutton role=\"button\"\u003e \u003c/button\u003e\n```\n\n**2) native요소의 의미, 기능 변경을 하지 않는다.**\n\n```html\n\u003ch1 role=\"button\"\u003e버튼\u003c/h1\u003e\n```\n\n**3) 키보드로 포커싱이 가능하게 설정한다.**\n\n```html\n\u003cspan role=\"button\" tabindex=\"0\"\u003e버튼\u003c/span\u003e\n```\n\n특히 button으로 사용하는경우\n\n```typescript\naria-hidden=\"true\"\n스크린리더가 접근하지는 않지만, 이미지를 보여주고 싶은 경우\n```\n\n[https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles](https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles)\n\n"])</script><script>self.__next_f.push([1,"13:Tc66,"])</script><script>self.__next_f.push([1,"\n이번에 스터디를 하면서 처음 스토리북을 써보게 되었다.\n\n[https://storybook.js.org/](https://storybook.js.org/)\n\n\n스토리북은 디자인 시스템을 구축하고자하는 개발자들을 위해 제작되었다.\n\n**디자인 시스템은 왜 사용하는 걸까?**\n\n개발자 입장에서 가장 큰 이유는 디자이너, 프로젝트 매니저 등 팀 구성원과의 협업인것 같다.\n\n각 분야의 지식 차이를 줄이고 공통적으로 바라보는 것(UI)을 통해 생산성을 높일 수 있다.\n\n**디자인 시스템이 뭔데?**\n\n\u003cimg src=\"/assets/blog/javaScript/storybook.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n내가 생각하기에 디자인 시스템이란 하나의 프로덕트를 만드는데 있어서 디자인 적인 가이드 라인 및 디자인 원칙 = 색상, 아이콘, 타이포그래피 등 을 체계적으로 관리하고 문서화하는것 이라 생각한다.\n\n이것을 문서화하는데 도와주는 도구가 바로 스토리북이다.\n\n---\n\n우리는 먼저 공통적으로 사용되는 컴포넌트와, 자주 쓰이게 될만한 컴포넌트들을 작성하기로 시작했다.\n\n```shell\nnpx storybook init\n```\n\n본인이 사용하고자하는 프레임워크를 설치하고 위 명령어를 터미널에 입력하면 알아서 설치된다 \n\n```shell\nyarn storybook\n```\n\n로 시작하면 6006포트로 실행된다\n\n/src/components/Chip.tsx\n\n```js\n{...}\n\nconst Chip = ({\n  adornments = \"#\",\n  label = \"Chip\",\n  color = \"basic\",\n  variants,\n  outlined,\n  onDelete,\n}: ChipProps) =\u003e {\n  const props = { color, variants, outlined };\n\n  return (\n    \u003cStyledChip {...props}\u003e\n      {adornments \u0026\u0026 \u003cStyledChipAdornments\u003e{adornments}\u003c/StyledChipAdornments\u003e}\n      \u003cStyledChipLabel {...props}\u003e{label}\u003c/StyledChipLabel\u003e\n      {onDelete \u0026\u0026 (\n        \u003cCancelIconBtn value={label} onClick={onDelete}\u003e\n          \u003cStyledCancelIcon aria-hidden {...props} /\u003e\n        \u003c/CancelIconBtn\u003e\n      )}\n    \u003c/StyledChip\u003e\n  );\n};\n\nexport default Chip;\n\n{...}\n```\n\n배포 후 우리가 실제로 사용할 컴포넌트다\n\n다양한 색상으로 받기위해\n\n```ts\nexport type Color = \"basic\" | \"active\" | \"danger\" | \"warning\";\n```\n\n을 작성했다.\n\n\u003cimg src=\"/assets/blog/javaScript/storybook.gif\" width=\"100%\" alt=\"post image\"/\u003e\n\n/src/stories/Chip.stories.tsx\n\n```tsx\nimport { Meta, Story } from \"@storybook/react\";\nimport React from \"react\";\nimport { Chip, ChipProps } from \"../../../components/Chip\";\n\nexport default {\n  title: \"Components/Chip\",\n  component: Chip,\n} as Meta;\n\nexport const Default: Story\u003cChipProps\u003e = (args) =\u003e {\n  return \u003cChip {...args} /\u003e;\n};\n```\n\n여기서 우리가 만든 컴포넌트들을 문서화 할 수 있다\n\nargs을 넣어줄 수 있는데, 스토리북에서는 자동으로 설정해준다.\n\n```js\nDefault.args = {\n  color: \"active\",\n};\n```\n\n로 직접 정의할 수도 있다.\n\n우리는 npm으로 배포해 사용하기로 했다. 다음엔 배포과정과 빌드과정을 정리해야겠다.\n\n작성한 디자인 시스템을 기반으로 이번주부터 직접 개발에 들어가게된다.\n\n어떤점이 좋은지 차이가있는지 경험해보는 좋은 기회가 될거같다.\n"])</script><script>self.__next_f.push([1,"14:Td1c,"])</script><script>self.__next_f.push([1,"\nNextjs에서 styled-components를 사용하면 서버상에서 html을 불러온 뒤, hydrate과정에서 js를 입혀 스타일이 적용된다.\n\n이때 초기 페이지 로딩시 사용자가 보게 되는 화면은, 스타일링이 전혀 적용되지않은 html문서를 잠깐 보게 되는 문제가 있다.\n\n\u003cimg src=\"/assets/blog/javaScript/next-styled-component.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n네트워크 탭에서 받아온 문서(페이지)를 보면 style에 관한 정보는 없고, html만 내려온다.\n\n이럴때 **\\_document.tsx**를 커스텀해 사용할 수 있다.\n\n\\_document는 Page를 렌더링하는데 공통적으로 필요한 태그, 메타정보, 폰트 등을 커스텀 하는데 사용할 수 있다.\n\n또 document는 항상 서버상에서만 실행되므로 브라우저 및 클라이언트 단에서 포함된 코드들은 실행되지 않는다.\n\n---\n\n첫번째로 styled-components의 서버측 className과 클라이언트측 className을 동일하게 유지되도록 하기 위해서 next.config.js를 수정해야된다.\n\nnextjs 12.1버전 이상부터는 babel-plugin-styled-components를 사용하지 않아도 되고,\n\n```javascript\ncompiler: {\n  styledComponents: true\n},\n```\n\n만 작성해 주면 된다.\n\n두번째로 \n\n```javascript\nimport Document, {DocumentContext} from 'next/document'\nimport {ServerStyleSheet} from 'styled-components'\n\nclass MyDocument extends Document {\n  static async getInitialProps(ctx: DocumentContext) {\n    const sheet = new ServerStyleSheet()\n    const originalRenderPage = ctx.renderPage\n\n    try {\n      ctx.renderPage = () =\u003e\n        originalRenderPage({\n          enhanceApp: (App) =\u003e (props) =\u003e sheet.collectStyles(\u003cApp {...props} /\u003e)\n        })\n\n      const initialProps = await Document.getInitialProps(ctx)\n\n      return {\n        ...initialProps,\n        styles: [\n          \u003c\u003e\n            {initialProps.styles}\n            {sheet.getStyleElement()}\n          \u003c/\u003e\n        ]\n      }\n    } catch (error) {\n      throw error\n    } finally {\n      sheet.seal()\n    }\n  }\n}\n\nexport default MyDocument\n```\n\n\\_document.tsx 파일을 위처럼 작성해 주면 된다.\n\n\b\b위 코드는 초기 서버측에서 페이지를 불러올 때 스타일을 입혀 불러오도록 설정하는 코드다.\n\ngetInitialProps에서 받아온 ctx에서 renderPage객체를 찾아 볼 수 있는데, renderPage는 CSS-in-JS라이브러리를 커스텀할 때 만 사용하라고 공식문서에 나와있다.\n\nrenderPage 함수를 콘솔에 찍어보니, 우리가 보는 html페이지와 리액트컴포넌트들이 담겨있는 것 같다.\n\nstyled-components 라이브러리에서 ServerStyleSheet를 import하고 서버측에서 그려질 sheet를 새로 만든다.\n\n```javascript\nconst sheet = new ServerStyleSheet()\n```\n\n새로 만든 sheet에 renderPage에 있는 컴포넌트내부에 styled-components로 작성한 스타일들을 결합하고,\n\n```javascript\nctx.renderPage = () =\u003e\n  originalRenderPage({\n    enhanceApp: (App) =\u003e (props) =\u003e sheet.collectStyles(\u003cApp {...props} /\u003e)\n  })\n```\n\n기존에 html에 style태그를 추가한다.\n\n```javascript\nreturn {\n  ...initialProps,\n  styles: [\n    \u003c\u003e\n      {initialProps.styles}\n      {sheet.getStyleElement()}\n    \u003c/\u003e\n  ]\n}\n```\n\n\u003cimg src=\"/assets/blog/javaScript/next-styled-component(1).png\" width=\"100%\" alt=\"post image\"/\u003e\n"])</script><script>self.__next_f.push([1,"15:Te30,"])</script><script>self.__next_f.push([1,"\n프로젝트를 진행하면서, 프로필 페이지에 유저정보와 포인트, 펫정보, 관심사 등 세로로 길게~~배치된 UI, 각각의 정보들을 서버에서 데이터를 하나하나 받아와 보여줘야 했다.\n\n처음엔 아무생각없이 진행했다.\n\n프로필 페이지에 진입했을 때 각각 필요한 데이터를 서버에 4번이나 요청했고, 그대로 컴포넌트에 그렸다.\n\n그러다가💡 생각났는데,, 사용자에게 보이지않는 부분에 데이터도 받아오고 있었다.\n\n굳이 스크롤을 내리지도 않고 사용자에게 보이지도 않는 부분에 데이터까지 받아올 필요는 없었다.\n\n그럼 사용자가 스크롤을 내려 보고자하는 부분에 도달했을때, 아니면 도달하기 직전에 데이터를 불러와 보여주면 어떨까 싶었다.\n\n이전에 강의에서 이미지 Lazy로딩을 배웠었는데, 이미지 대신에 데이터 요청을 해보면 어떨까 생각했다.\n\n\u003cimg src=\"/assets/blog/javaScript/intersectionObserver.png\" width=\"100%\" alt=\"post image\" /\u003e\n\n컴포넌트가 마운트 되자마자 모든 데이터들이 요청된다.\n\n우선 훅을 하나 만들었다. ref객체가 감지되면 loaded가 true로 바뀌고, 더이상 감시가 중지된다.\n\n```tsx\nexport const useLazyRequest = () =\u003e {\n  const ref = useRef(null) as MutableRefObject\u003cHTMLDivElement\u003e\n  const [loaded, setLoaded] = useState\u003cboolean\u003e(false)\n\n  useEffect(() =\u003e {\n    const options = {}\n    const callback = (entries, observer) =\u003e {\n      entries.forEach((entry) =\u003e {\n        console.log(entry)\n        if (entry.isIntersecting) {\n          console.log('is Intersecting')\n          setLoaded(true)\n          observer.unobserve(entry.target) // 한번만 요청되도록 감시 중지\n        }\n      })\n    }\n    const observer = new IntersectionObserver(callback, options) // 객체 생성하기\n    observer.observe(ref.current)\n  }, [])\n\n  return {ref, loaded}\n}\n```\n\n사용하고자 하는 컴포넌트로 돌아와서,\n\n나는 데이터 요청에 SWR을 사용했다.\n\n[https://swr.vercel.app/ko](https://swr.vercel.app/ko)\n\n```tsx\n\n// SWR\nexport const useUserKeywords = (loaded: boolean) =\u003e {\n  const {data, isValidating, error} = useFetch(loaded ? PATH + '/keywords' : null, {\n    revalidateOnFocus: false,\n    revalidateIfStale: false,\n    shouldRetryOnError: false\n  })\n\n  return {\n    userKeywords: data,\n    isValidating,\n    error\n  }\n}\n```\n\nSWR은 위처럼 설정했다, SWR자체도 hook이기 때문에 useEffect나 다른 함수안에서 사용하지 못한다.\n\n```tsx\nconst {ref, loaded} = useLazyRequest()\nconst {userKeywords, isValidating, error} = useUserKeywords(loaded)\n\n\u003cContents ref={ref}\u003e\n        {isValidating ? (\n          \u003cLoading /\u003e\n        ) : (\n          \u003c\u003e\n           {...}\n          \u003c/\u003e\n        )}\n\u003c/Contents\u003e\n```\n\n4개의 섹션이 있는데, 페이지 진입시 1, 2번까지만 사용자에게 보이고 3, 4번의 컴포넌트를 위처럼 적용했다.\n\nref에 사용자의 view가 도달하면 userKeywords를 요청해 데이터를 받아온다.\n\n\u003cimg src=\"/assets/blog/javaScript/intersectionObserver(1).gif\" width=\"100%\" alt=\"post image\" /\u003e\n\n과거에는 getBoundingClientRect() 를 사용해 구현했다고 하는데, 리플로우 현상이나 성능면에서 보완하고자 요즘엔 intersection Observer를 사용해 타겟을 관찰한다고 한다.\n\n또 무한스크롤도 구현해 볼 수 있다. 페이지의 맨 마지막 요소에 도달했을 때, 요청하는 페이지 쿼리를 ++ 하면 쉽게 구현할 수 있다.\n\n다른 필요한 페이지에 적용해봐야겠다!\n"])</script><script>self.__next_f.push([1,"16:T1130,"])</script><script>self.__next_f.push([1,"\n\n이번 새로운 프로젝트에 사용하게 된 react-hook-form과 씨름하면서 정리해본 ref와 react-hook-form의 간단한 원리에 대해 정리해보자.\n\n---\n\n### **ref**란?\n\nReact에서는 props를 통해서만 부모와 자식간의 컴포넌트에 상호작용을 할 수 있다.\n\n자식 컴포넌트에 props를 전달해 props의 값이 변경되면 자식 컴포넌트는 다시 렌더링이 된다.\n\n그러나 props를 통한 방법이 아닌 직접적으로 자식 컴포넌트를 수정해야되는 일이 생길 수 있는데..\n\n### Ref를 사용해야 할 때\n\n-   포커스, 텍스트 선택영역, 혹은 미디어의 재생을 관리할 때.\n-   애니메이션을 직접적으로 실행시킬 때.\n-   서드 파티 DOM 라이브러리를 React와 같이 사용할 때.\n\n우선 DOM에 직접적으로 접근하는 방법은 건너 뛰고, react-hook-form과 관련된 **비제어 컴포넌트 제어**에 관해 알아보자.\n\n**react-hook-form**의 가장 큰 목적은 퍼포먼스이며, **비제어 컴포넌트**를 사용하고 있기 때문에 다른 라이브러리(formik, redux-form 등) 에 비해 타이핑이나 값이 변경될 때 리랜더링이 일어나는 양을 줄여준다.\n\n여기서 비제어 컴포넌트란, \n\nReact에서 제어하지 않고, 바닐라 JS를 이용해 제어하는 컴포넌트를 비제어 컴포넌트라 한다.\n\n쉽게말해 React가 관여하지 않는다. (재조정, 비교 등)\n\n이런 비제어 컴포넌트를 제어하기 위해서, DOM에 접근하는 역할을 ref가 한다.\n\n예를들어\n\n```javascript\nconst [test, setTest] = useState('')\n\u003cinput value={test} onChange={(e) =\u003e setTest(e.target.value)} /\u003e\n```\n\n위와같이 state로 상태를 관리하게 되면, state가 변하면서 이를 업데이트 하기 위해 계속해서 리렌더링이 된다.\n\n\u003cimg src=\"/assets/blog/javaScript/ref.gif\" width=\"100%\" alt=\"post image\"/\u003e\n\n이는 React에서 제어하는 컴포넌트다.\n\n그러면 굳이 인풋에 값만 변하는건데 불필요한 리렌더링이 필요하지 않을 수 있다.\n\n```\n  const inputRef = useRef(null)\n  const testHandler = (e) =\u003e {\n    inputRef.current.value = e.target.value\n  }\n    \u003cinput ref={inputRef} onChange={(e) =\u003e testHandler(e)} /\u003e\n```\n\n\u003cimg src=\"/assets/blog/javaScript/ref(1).gif\" width=\"100%\" alt=\"post image\"/\u003e\n\nref를 사용하면 인풋값이 변경되어도 리렌더링이 발생하지 않는다.\n\n---\n\n### Ref 와 함수형 컴포넌트\n\n-   함수 컴포넌트는 인스턴스가 없기 때문에 **함수 컴포넌트에 ref 어트리뷰트를 사용할 수 없습니다**.\n\n사실 위 예제는 클래스형 컴포넌트에서 작성해야 적합했지만, 함수형 컴포넌트에서도 ref는 사용할 수 있다.\n\n다만 상태값이 바뀔 때 마다 다시 실행되는 함수형 컴포넌트의 특성때문에 기존과는 다른 방식을 사용한다.\n\n위 예제에서 사용한 **useRef는 hook으로 함수의 렌더링의 상관없이** 상태 값을 유지한다.\n\n---\n\n### forwardRef\n\nreact-hook-form을 사용하면서 \n\n**Warning: Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?**\n\n이런 에러를 만나게 됐는데, ref 기반으로 구성된 react-hook-form이 ref를 **자식요소(인풋컴포넌트)에 전달**하기 때문에 발생한 에러였다.\n\nref는 React에서 props로 사용하지 못하는 것 중에 하나였는데, 대표적인 Key값과 동일하게 **props로 사용할 수 없다**.\n\nReact에서 ref를 props로 사용하려면 forwardRef를 사용해 자식요소로 ref를 전달할 수 있다.\n\n자식 컴포넌트를 forwardRef()함수로 감싸주고, props와 ref를 받아 사용할 수 있다.\n\n```\nconst Input = forwardRef((props, ref) =\u003e {\n  return \u003cinput ref={ref} /\u003e;\n});\n```\n\n추가로 eslint 에러나 개발자 도구에서 forwardRef사용시 이름이 나오지 않는 에러는\n\ndisplayName 속성에 이름을 설정하거나, 익명함수 대신 이름있는 함수를 넘겨 주면 된다.\n\n```\nInput.displayName = \"Input\";\n```\n\n```\nconst Input = forwardRef(function Input(props, ref) {\n  return \u003cinput ref={ref} /\u003e;\n});\n```\n\n---\n\nref는 특정 DOM에 접근해 애니메이션을 이용할때만 주로 사용했었는데, 이번 기회에 조금 더 자세하게 들여다 본것 같다.🤔\n"])</script><script>self.__next_f.push([1,"17:T18c7,"])</script><script>self.__next_f.push([1,"\n이번에 유지보수하면서 진행했던 TTS (Text-to-Speech)\n\n단어의 발음을 읽어주도록 해야했다.\n\n결국 Google TTS로 구현하긴 했지만, 처음에는 Speechsynthesis를 사용해 구현했었다.\n\nSppechsynthesis는 (음성 합성) Web Speech API이고 주어진 텍스트를 소리로 바꿔주는, 음성 서비스에 대한 컨트롤러 인터페이스이다.\n\n---\n\n### Speechsynthesis\n\nIE빼고 브라우저 거의 지원한다.\n\n```javascript\nspeechSynthesis.getVoices();\n```\n\n로 지원하는 음성 목록을 확인할 수 있다.\n\n\n\u003cimg src=\"/assets/blog/javaScript/speechsynthesis.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n문제는,, 브라우저마다 또는 OS마다 지원하는 음성이 달라서 모두 동일하지 못했다,\n\n그래서 모바일따로 웹따로 브라우저별로 목소리가 다르게 세팅되어 Google TTS로 바꾸게 되었다.\n\n```javascript\nconst speech = new SpeechSynthesisUtterance()\n\n// 음높이와 목소리 등 설정이 가능\nspeech.voice\nspeech.text\nspeech.lang\nspeech.pitch\nspeech.rate\nspeech.volume\n```\n\n```\n// speechSynthesisUtterance에 설정한 음성 실행\nwindow.speechSynthesis.speak(speech)\n```\n\n---\n\n### Google TTS\n\n두가지 방식이 있었다.\n\n클라이언트 라이브러리와 API\n\n클라이언트 라이브러리\n\n#### Node.js\n\n```javascript\nnpm install --save @google-cloud/text-to-speech\t//라이브러리 설치\n\n\n// Imports the Google Cloud client library\nconst textToSpeech = require('@google-cloud/text-to-speech');\n\n// Import other required libraries\nconst fs = require('fs');\nconst util = require('util');\n// Creates a client\nconst client = new textToSpeech.TextToSpeechClient();\nasync function quickStart() {\n  // The text to synthesize\n  const text = 'hello, world!';\n\n  // Construct the request\n  const request = {\n    input: {text: text},\n    // Select the language and SSML voice gender (optional)\n    voice: {languageCode: 'en-US', ssmlGender: 'NEUTRAL'},\n    // select the type of audio encoding\n    audioConfig: {audioEncoding: 'MP3'},\n  };\n\n  // Performs the text-to-speech request\n  const [response] = await client.synthesizeSpeech(request);\n  // Write the binary audio content to a local file\n  const writeFile = util.promisify(fs.writeFile);\n  await writeFile('output.mp3', response.audioContent, 'binary');\n  console.log('Audio content written to file: output.mp3');\n}\nquickStart();\n```\n\n구글의 샘플코드\n\n위 코드로 테스트해보니 output.mp3 파일이 만들어지고 이 파일을 재생하면 요청한 text가 재생됐다.\n\n하지만 파일도 필요없고, 음성만 클라이언트에서 받으면 됐기 때문에 조금 더 살펴봤는데, reponse 부분에서 arrayBuffer의 버퍼데이터가 찍혔고, 이 response 데이터를 바로 클라이언트로 보내줬다.\n\n#### React\n\n```javascript\n      const requestAudioFile = async (e) =\u003e {\n            const audioContext = new (window.AudioContext || window.webkitAudioContext)\n\n            const response = await axios({\n                method: 'get',\n                url: `http://localhost:4000/exam1`,\n                params: {test: e.target.ariaValueText},\n                responseType: 'arraybuffer'\n            })\n\n            // 버퍼 데이터 비동기 디코딩\n            const audioBuffer = await audioContext.decodeAudioData(response.data)\n\n            // 오디오 source 만들기\n            const gainNode = audioContext.createGain()\n            const source = audioContext.createBufferSource()\n\n            // 생성된 source에 재생할 데이터 선언\n            source.buffer = audioBuffer\n            source.connect(gainNode)\n\n            // 재생할 스피커에 source 넣기\n            gainNode.connect(audioContext.destination)\n            source.start()\n\n            console.log('responce', response.data);\n            console.log('audioContext', audioContext);\n            // -------------- //\n            const audioBuffer = await audioContext.decodeAudioData(decode);\n            console.log('audioBuffer', audioBuffer);\n            //create audio source\n              const gainNode = audioContext.createGain()\n              const source = audioContext.createBufferSource()\n            console.log('source : ', source);\n\n              source.buffer = audioBuffer\n              source.connect(gainNode)\n              gainNode.connect(audioContext.destination)\n\n            source.start();\n        }\n```\n\n읽혀야할 text를 params로 보냈고, Web Audio API 의 AudioContext를 사용해서 받아온 버퍼데이터를 읽도록 했다.\n\n근데 몇가지 문제가 더 있었는데, 모바일에서는 작동하지 않는것..audio 태그를 이용해 읽혀야 하기 때문에 버튼 커스텀이 되지 않았다.\n\n그래서 변경한게 API\n\n```\nPOST https://texttospeech.googleapis.com/v1/text:synthesize?key='Google API KEY'\n```\n\n```json\n{\n  \"input\":{\n    \"text\":\"Android is a mobile operating system developed by Google, based on the Linux kernel and designed primarily for touchscreen mobile devices such as smartphones and tablets.\"\n  },\n  \"voice\":{\n    \"languageCode\":\"en-gb\",\n    \"name\":\"en-GB-Standard-A\",\n    \"ssmlGender\":\"FEMALE\"\n  },\n  \"audioConfig\":{\n    \"audioEncoding\":\"MP3\"\n  }\n}\n```\n\n위처럼 작성해 POST요청을 보내면  \n\n```\n//NExAARqoIIAAhEuWAAAGNmBGMY4EBcxvABAXBPmPIAF//yAuh9Tn5CEap3/o\n...\nVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV\n```\n\n음성이 base64 인코딩 형식으로 들어온다.\n\n받은 인코딩된 음성을\n\n```javascript\nconst [audioSource, setAudioSource] = useState(null)\n\nconst requestAudioFile = async (e) =\u003e {\n  const response = await axios.post(\n      // eslint-disable-next-line no-undef\n    `https://texttospeech.googleapis.com/v1/text:synthesize?key=${process.env.REACT_APP_GOOGLE_TTL}`,\n    {\n      input: {\n        text: e?.target?.ariaValueText\n      },\n      voice: {\n        languageCode: 'en-US',\n        name: 'en-US-Standard-H',\n        ssmlGender: 'FEMALE'\n      },\n      audioConfig: {\n        audioEncoding: 'LINEAR16',\n        speakingRate: 1\n      }\n    }\n  );\n  setAudioSource(new Audio(\"data:audio/wav;base64,\" + response.data?.audioContent));\n};\n\n    useEffect(() =\u003e {\n        audioSource?.play()\n    }, [audioSource])\n```\n\nnew Audio 오디오 객체를 이용해 오디오소스가 들어올때, 오디오를 만들고 재생시켰다.\n"])</script><script>self.__next_f.push([1,"18:Tf2b,"])</script><script>self.__next_f.push([1,"\n**[유동균님의 강의](https://www.inflearn.com/course/%EC%9B%B9-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-%EB%A6%AC%EC%95%A1%ED%8A%B8-1)를 보며 정리한 글 입니다.**\n\n---\n\n### 1\\. Layout Shift\n\n원인\n\n1\\. 사이즈가 정해져 있지 않은 이미지\n\n2\\. 사이즈가 정해져 있지 않은 광고\n\n3\\. 동적으로 삽입된 콘텐츠\n\n4\\. Web font (FOIT, FOUT)\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-3-1.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n여러 이미지를 로드할 때, 먼저 불러온 이미지 자리를 나중에 불러온 이미지가 밀어내게 되면서 레이아웃 변경이 계속 발생한다.\n\n```js\n\u003cImageWrap\u003e\n  \u003cImage /\u003e\n\u003c/ImageWrap\u003e\n```\n\n이때 Wrap에 고정값을 정해주고 Image는 그 값을 따라가기만 하면 된다. 여기서는 16:9 비율로 지정하기 위해 9 / 16 = 56.25%로 높이를 잡고 Image를 그 안에 넣는 방식으로 했다.\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-3-2.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n컨텐츠가 새로 들어오면서 기존 컨텐츠를 밀어내지 않도록 컨텐츠를 그려줄 곳에 미리 자리를 만들어 놓는것이다.\n\n---\n\n### 2\\. React-lazyload\n\n```shell\nnpm i react-lazyload\n```\n\n강의에서는 라이브러리를 사용했지만, 다음엔 스스로 구현해 포스팅해야겠다.\n\n스크롤이벤트를 사용하는 것 같다.\n\n---\n\n### 3\\. useSelect 렌더링 문제\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-3-3.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n리액트 dev-tool에서 Highlight updates ... 를 체크해 컴포넌트가 렌더링되는걸 확인할 수 있다.\n\nuseSelector는 dispatch로 Redux Store가 변경되면 구독하고 있는 컴포넌트에 state가 변경되었다고 알려준다.\n\n그럼 컴포넌트에서는 기존 state와 업데이트된 state를 비교해 값이 다르면 다시 렌더링 하게 된다.\n\n여기서 비교하는 방식은 useSelector의 리턴값을 비교하는데\n\n```js\nconst { modalVisible, bgColor, src, alt } = useSelector(state =\u003e ({\n  modalVisible: state.modalVisible,\n  bgColor: state.bgColor,\n  src: state.src,\n  alt: state.alt,\n}));\n```\n\n리턴값을 오브젝트 형식으로 작성하면, 값을 생성할 때 마다 새로운 오브젝트를 만들기 때문에 매번 새롭게 렌더링하게 된다.\n\n```js\nconst modalVisible = useSelector(state =\u003e state.modalVisible)\nconst bgColor = useSelector(state =\u003e state.bgColor)\nconst src = useSelector(state =\u003e state.src)\nconst alt = useSelector(state =\u003e state.alt)\n```\n\n오브젝트를 새롭게 만들지 않도록 state를 쪼개고 새로운 Equality Function을 사용해야한다.\n\n```js\nconst { modalVisible, bgColor, src, alt } = useSelector(state =\u003e ({\n  modalVisible: state.modalVisible,\n  bgColor: state.bgColor,\n  src: state.src,\n  alt: state.alt,\n}), shallowEqual);\n```\n\n---\n\n### 4\\. Redux Reselect\n\nstate의 값들을 가지고 가공해야되는 값이 있을 때 useSelector내부에서 가공해 값을 준다.\n\n```js\nconst selectFilteredPhotos = createSelector([select값], (select값) =\u003e (가공할 결과를 리턴)\nconst photos = useSelector(selectFilteredPhotos)\n```\n\n또 메모이제이션 방식을 통해 값을 비교하므로 불필요한 계산도 없애준다.\n\nselect값이 같은 값으로 들어오면 미리 캐싱해둔 값과 비교해 값이 변하지 않으면 그대로 리턴한다.\n\n---\n\n### 5\\. Memoization 적용\n\n인풋에 따라 아웃풋에 나오는 값에 대해서 미리 저장해 놓는 기법이다.\n\na -\u003e A가 아웃풋이다 라고 할때, 다음번에 또 a가 들어오면 로직을 일일히 실행하지않고 저장해둔 값 A를 바로 리턴하게 된다.\n\n순수함수만 가능\n\n그렇다고 무지성으로 쓰는건 좋지 않다.\n\n메모이제이션이 불필요한 함수에 적용하는건 오히려 메모리 낭비가 될 수 있다.\n"])</script><script>self.__next_f.push([1,"19:T2721,"])</script><script>self.__next_f.push([1,"\n**[유동균님의 강의](https://inf.run/4zeg)를 보며 정리한 글 입니다.**\n\n---\n\n### 1\\. 이미지 지연(lazy) 로딩\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-1.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n예제에서 네트워크를 6메가비트로 맞춰놓았다.\n\n제일 먼저 사용자에게 보여져야할 동영상이 이미지 보다 더 늦게 다운로드 되는 부분을 동영상이 먼저 다운로드 되도록 수정해야한다.\n\n-   이미지를 빠르게 다운로드\n-   **이미지를 나중에 다운로드, 동영상 먼저 다운로드**\n\n두번째 방법을 사용해 수정(image lazy)\n\n이미지를 필요할때(나중에, 보여지기 직전에) 로드되도록 해야한다.\n\n스크롤이 이미지가 있는 곳에 도달하면 이미지를 로드하고, 그렇지 않으면 보이지 않도록 해야하는데,\n\n이 방법은 사용자가 매번 스크롤을 할 때마다 이벤트함수가 호출되는 단점이 있다.\n\n이 문제를 해결하려면 **IntersectionObserver**로 해결할 수 있다. 즉 화면에 특정 이미지가 들어올 때만 함수를 호출하게 된다.\n\n[https://developer.mozilla.org/ko/docs/Web/API/Intersection\\_Observer\\_API](https://developer.mozilla.org/ko/docs/Web/API/Intersection_Observer_API)\n\n```js\nconst observer = new IntersectionObserver(callback, options)\nobserver.observe(element객체)\n```\n\n```js\n    const imgRef = useRef(null)\n\n   useEffect(() =\u003e {\n      const options = {}\n      const callback = () =\u003e {\n         console.log('callback')\n      }\n      const observer = new IntersectionObserver(callback, options)\n\n      observer.observe(imgRef.current)\n   }, [])\n\n\n   return (\n      \u003cdiv className=\"Card text-center\"\u003e\n         \u003cimg src={props.image} ref={imgRef} /\u003e\n         \u003cdiv className=\"p-5 font-semibold text-gray-700 text-xl md:text-lg lg:text-xl keep-all\"\u003e\n            {props.children}\n         \u003c/div\u003e\n      \u003c/div\u003e\n   )\n}\n```\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-2.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n스크롤을 내려 이미지가 **보이거나 사라질때** 콘솔이 찍힌다.\n\n이미지가 보이는 그 순간에만 로드하려면 callback 함수에 entries와 observer객체를 넘겨주면 된다.\n\n```js\nuseEffect(() =\u003e {\n   const options = {}\n   const callback = (entries, observer) =\u003e {\n      entries.forEach(entry =\u003e {\n         if(entry.isIntersecting){\n            console.log('is Intersecting')\n         }\n      })\n   }\n   const observer = new IntersectionObserver(callback, options)\n\n   observer.observe(imgRef.current)\n}, [])\n```\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-3.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n위와는 다르게 화면안에 이미지가 **보일 때만** 콘솔이 찍힌다.\n\n```js\n    const imgRef = useRef(null)\n\n    useEffect(() =\u003e {\n        const options = {}\n        const callback = (entries, observer) =\u003e {\n            entries.forEach(entry =\u003e {\n                if(entry.isIntersecting){\n                    console.log('is Intersecting', entry.target.dataset.src)\n                    entry.target.src = entry.target.dataset.src\n                    // 이미지가 들어오면 더이상 감시하지 않음\n                    observer.unobserve(entry.target)\n                }\n            })\n        }\n        const observer = new IntersectionObserver(callback, options)\n        // 이미지를 넣음\n        observer.observe(imgRef.current)\n    }, [])\n\n\n    return (\n        \u003cdiv className=\"Card text-center\"\u003e\n            \u003cimg data-src={props.image} ref={imgRef}/\u003e\n            \u003cdiv className=\"p-5 font-semibold text-gray-700 text-xl md:text-lg lg:text-xl keep-all\"\u003e\n                {props.children}\n            \u003c/div\u003e\n        \u003c/div\u003e\n    )\n}\n```\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-4.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n동영상을 먼저 로드하고, 이미지를 불러옴\n\n---\n\n### 2\\. 이미지 사이즈 최적화\n\n위에서 지연로딩을 사용해 이미지를 불러오는 타이밍을 조절했지만 그래도 이미지 자체의 용량이 크다면 불러오는 속도가 느려질 수 밖에 없다.\n\n이미지 포맷, 확장자 종류\n\n- JPG를 **WEBP**(구글에서 나온 이미지 포맷, JPG에 비해서 화질이높고 용량이 낮음)로 변경,\n\n* 꼭 WEBP로 할필요는 없다 (**WEBP, WEBM**은 현재 잘 쓰지 않는다) 현재 지원하지않는 브라우저도 있음\n\n**picture** 태그로 이미지 분기(나중에 자세하게 배워보자)\n\n```html\n\u003cpicture\u003e\n   \u003csource  data-srcset={props.webp} type='image/webp'/\u003e\n   \u003cimg data-src={props.image} ref={imgRef}/\u003e\n\u003c/picture\u003e\n```\n\n이미지 포맷은 [https://squoosh.app/](https://squoosh.app/) 를 사용했다.\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-5.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n예제에서 브라우저에 보일 크기는 300 x 300 이므로 **x2**를해 600 x 600으로 포맷\n\n이미지가 9.74MB에서 **21.9KB**로 줄었다.\n\n---\n\n### 3\\. 동영상 사이즈 최적화\n\n동영상이 메인 컨텐츠가 아닌 경우 적합\n\n동영상도 **WEBM**으로 포맷\n\n```html\n\u003cvideo\n   className=\"absolute translateX--1/2 h-screen max-w-none min-w-screen -z-1 bg-black min-w-full min-h-screen\"\n   autoPlay\n   loop\n   muted\n\u003e\n   \u003csource src={video_webm} type='video/webm' /\u003e\n   \u003csource src={video} type='video/mp4' /\u003e\n\u003c/video\u003e\n```\n\n---\n\n### 4\\. 폰트 최적화\n\n폰트도 리소스라 네트워크를 통해 받아온다.\n\n- 웹 폰트의 문제점\n\n**FOUT**(Flash of Unstyled Text) = 폰트를 다운로드 하기 전에는 **기본폰트로 컨텐츠**를 보여줌\n\n**FOIT**(Flash of Invisible Text) = 폰트가 다운로드 되기 전에는 **컨텐츠를 보여주지 않음**\n\n1. 폰트 적용 시점 컨트롤\n\n-   font-display 사용\n    \\- auto : 브라우저 기본 동작\n    \\- block : FOIT (timeout = 3s)\n    \\- swap : FOUT\n    \\- fallback : FOIT (timeout = 0.1s) 0.1초 후에도 불러오지 못하면 **기본 폰트 유지**, 이후에 캐시\n    \\- optional : FOIT (timeout = 0.1s) 이후 네트워크 상태에 따라 **기본폰트로 유지할지 웹폰트를 적용할지 결정**, 이후에 캐시\n\n```css\n@font-face {\n\tfont-family: BMYEONSUNG;\n\tsrc: url('./assets/fonts/BMYEONSUNG.ttf');\n\tfont-display: swap;\n}​\n```\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-6.gif\" width=\"100%\" alt=\"post image\"/\u003e\n\n-   fontfaceobserver 라이브러리를 사용해 시각적인 효과\n\n```css\n@font-face {\n   font-family: BMYEONSUNG;\n   src: url('./assets/fonts/BMYEONSUNG.ttf');\n   font-display: block;\n}\n```\n\n```js\nconst [isFontLoaded, setIsFontLoaded] = useState(false)\n\nconst font = new FontFaceObserver('BMYEONSUNG');\n\nuseEffect(() =\u003e {\n   font.load().then(function () {\n      console.log('BMYEONSUNG has loaded');\n      setIsFontLoaded(true)\n   });\n}, [])\n\nreturn (\n    \u003cdiv className=\"...\" style={{opacity: isFontLoaded ? 1 : 0, transition: 'opacity 0.3s ease'}} \u003e\n        \u003cdiv className=\"...\"\u003e\n            {...}\n        \u003c/div\u003e\n    \u003c/div\u003e\n)\n```\n\n2. 폰트 사이즈 줄이기\n\n폰트 포멧 사이트 [https://transfonter.org/](https://transfonter.org/)\n\n- 웹폰트 포맷 사용 (파일 크기 = EOT \u003e TTF/OTF \u003e WOFF \u003e WOFF2)\n\n```css\n@font-face {\n   font-family: BMYEONSUNG;\n       /* 로컬에 폰트가 있으면 바로 적용*/\n   src: local('BMYEONSUNG'),\n       url('./assets/fonts/BMYEONSUNG.woff2') format('woff2'),\n       /* 지원하지 않는 브라우저 대응 */\n       url('./assets/fonts/BMYEONSUNG.woff') format('woff'),\n       url('./assets/fonts/BMYEONSUNG.ttf') format('truetype');\n   font-display: block;\n}\n```\n\n- local 폰트 사용\n\n- **Subset** 사용\n\n필요한 글자만 가져와서 사용 \"ABCDEFGHIJKLMNOPQR\"\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-7.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n변환하지 않은 폰트는 포함되지 않음\n\n- **Unicode Range** 적용\n\n```css\n@font-face {\n   font-family: BMYEONSUNG;\n        /* 로컬에 폰트가 있으면 바로 적용*/\n   src: url('./assets/fonts/subset-BMYEONSUNG.woff2') format('woff2'),\n        /* 지원하지 않는 브라우저 대응 */\n        url('./assets/fonts/subset-BMYEONSUNG.woff') format('woff'),\n        url('./assets/fonts/BMYEONSUNG.ttf') format('truetype');\n   font-display: block;\n   unicode-range: U+0041;\n}\n```\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-8.png\" width=\"100%\" alt=\"post image\"/\u003e\n\nSubset은 렌더링 하는 텍스트에 폰트가 필요하지 않아도 폰트를 로드하지만 unicode-range를 사용하면 폰트가 필요하지 않으면 로드하지 않는다\n\n- data-uri로 변환\n\nBase64 encode 해 불러오는 방식\n\n- **Preload**\n\n해당하는 페이지에 폰트가 필요하다는 것을 HTML에 작성\n\n```html\n\u003clink rel=\"preload\" href=\"BMYEONSUNG.woff2\" as=\"font\" type=\"font/woff2\" crossorigin\u003e\n```\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization-2-9.png\" width=\"100%\" alt=\"post image\"/\u003e\n\nCSS가 로드되기 전에 폰트가 먼저 로드됨\n\n---\n\n### 5\\. 캐시 최적화\n\n웹 브라우저는 크게 메모리 캐시, 디스크 캐시 두가지로 캐싱한다.\n\n**메모리 캐시는 RAM**에 저장, **디스크 캐시는 file로 데이터**를 저장\n\n- Cache-Control\n\n브라우저 이미지 요청 -\u003e 서버\n\n서버 -\u003e 브라우저에 이미지(캐시) 보냄\n\n* 서버에서 설정이 필요\n\n-   no-cache : 캐시를 사용하기 전에 서버에서 검사 후 사용 결정\n-   no-store : 캐시 사용 안함\n-   public : 모든 환경에서 사용\n-   private : 브라우저 환경에서만 캐시 사용, 외부 캐시 서버에서는 사용 불가\n-   max-age : 캐시의 유효시간\n\n- Node\n\n```js\nconst header = {\n    setHeaders: (res, path) =\u003e {\n    \tif(path.endsWith('.html')){\n        \tres.setHeader('Cache-Control', no-cache)\n        } else if(path.endsWith('.js') || path.endsWith('css') || path.endsWith('.webp')){\n        \tres.setHeader('Cache-Control', 'public, max-age=...'\n        } else {\n        \tres.setHeader('Cache-Control', 'no-store')\n        }\n    },\n}\n```\n"])</script><script>self.__next_f.push([1,"1a:T1f48,"])</script><script>self.__next_f.push([1,"\n**[유동균님의 강의](https://www.inflearn.com/course/%EC%9B%B9-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-%EB%A6%AC%EC%95%A1%ED%8A%B8-1)를 보며 정리한 글 입니다.**\n\n---\n\n### 1\\. 구글 개발자 도구 Audits(LightHouse) 툴을 이용한 페이지 검사\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization1.png\" width=\"100%\" alt=\"post image\"/\u003e\n\u003cimg src=\"/assets/blog/javaScript/web-optimization2.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n**Opportunities** = 리소스의 관점(로딩성능)\n\n**Diagnostics** = 페이지의 실행 관점(렌더링)\n\n---\n\n### 2\\. 이미지 사이즈 최적화 - 로딩 성능\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization3.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n실제 이미지와 렌더링된 이미지의 크기가 다르다\n\n보통 이미지는 x2의 이미지를 사용\n\napi를 통해 받아온 이미지를 조절하려면?\n\n**Image CDN**(image processing Contents Delivery Network) - 이미지 가공 → 소비자\n\nCDN 구축은 진행하지 않았다.\n\n---\n\n### 3\\. performance\n\n크롬 개발자도구 -\u003e 성능에서 새로고침을 누르면 페이지의 작업을 분석해준다.\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization4.png\" width=\"100%\" alt=\"post image\"/\u003e\n\u003cimg src=\"/assets/blog/javaScript/web-optimization5.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n1.  HTML파싱\n2.  JS 로드\n3.  \b첫 페인팅 이후 API 호출\n\n- 리액트는 프레임차트에서 각 컴포넌트마다 실행되는 시간이 보여진다.\n\n---\n\n### 4\\. Route-based code Splitting\n\n코드 스플릿팅은 webpack, rollup 등과 같은 모듈 번들러를 이용하여 만들어진 하나의 번들 파일을 여러 개의 번들 파일로 나누는 것을 의미한다.\n\n하나의 번들파일을 여러개로 나누면 그만큼 로드 속도가 빨라진다.\n\n```js\nimport React, {Suspense, lazy} from 'react'\nimport { Switch, Route } from 'react-router-dom'\nimport './App.css'\n// import ListPage from './pages/ListPage/index'\n// import ViewPage from './pages/ViewPage/index'\n\nconst ListPage = lazy(() =\u003e import('./pages/ListPage/index'))\nconst ViewPage = lazy(() =\u003e import('./pages/ViewPage/index'))\n\nfunction App() {\n  return (\n    \u003cdiv className=\"App\"\u003e\n        \u003cSuspense fallback={\u003cdiv\u003e로딩 중...\u003c/div\u003e}\u003e\n          \u003cSwitch\u003e\n            \u003cRoute path=\"/\" component={ListPage} exact /\u003e\n            \u003cRoute path=\"/view/:id\" component={ViewPage} exact /\u003e\n          \u003c/Switch\u003e\n        \u003c/Suspense\u003e\n    \u003c/div\u003e\n  )\n}\n\nexport default App\n```\n\nimport()를 **lazy**라는 함수 안에 넣고, **Suspense**라는 컴포넌트로 관리를 해줄 수 있다.\n\n데이터가 로딩중에 유저에게 비어있는 컴포넌트가 보이게 되는데, Suspense를 사용해서 이 로딩중인 상태일 때 다른 컴포넌트를 보여줄 수 있다.\n\nSuspense는 fallback을 받아 import하는 도중에 띄어준다.\n\n페이지가 로드될 때 그 페이지 안에서 보이지 않는 컴포넌트가 존재할 수 있는데, 이 부분을 스플리팅해 관리 할 수도 있다.\n\n---\n\n### 5\\. 애니메이션 최적화\n\n일반적인 모니터는 초당 60FPS, 브라우저도 초당 60FPS로 화면을 그리게 된다.\n\n여기서 브라우저가 60FPS 아래로 그리게 된다면 쟁크 현상이 발생함.\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization6.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n1. DOM + CSSOM\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization7.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n2. Render Tree\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization8.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n위 DOM과 CSSOM을 조합해 RenderTree를 만들어 낸다.\n\n3. Layout\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization9.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n위치나 크기를 계산해 화면에 레이아웃을 그린다.\n\n4. Paint\n\n이렇게 그려진 레이아웃위에 색을 채워넣음\n\n5. Composite\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization10.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n각 레이어들을 합성하는 과정\n\n이 전체의 과정을 Critical Rendering Path, Pixel Pipeline 이라고 부른다.\n\n이 완성된 상태에서 변화가 생긴다면 처음으로 돌아가 다시 이 전체의 과정을 거치게 된다.\n\n- width, height가 변경되면, **1 -\u003e 2 -\u003e 3 -\u003e 4 -\u003e 5** 모두 실행되게 된다 **(Reflow)**\n\n- 크기나 위치가 아니라 color, background-color(색깔)이 변경됐을땐 **1 -\u003e 2 -\u003e 4 -\u003e 5** **(Repaint)**\n\n- transform, opacity 등(GPU가 관여하는 속성) 변경일 때 **1 -\u003e 2 -\u003e 5**\n\n따라서 transform, opacity 등(GPU가 관여하는 속성)을 사용하는게 가장 빠르고 끊김없이 보여줄 수 있다.\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization11.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n---\n\n### 6\\. 컴포넌트 Lazy Loading, Preload\n\n위에서 했던것 처럼 이미지를 보여주는 모달만 따로 스플릿팅 할 수있다.\n\n```js\nimport React, { useState, Suspense, lazy } from 'react'\nimport styled from 'styled-components'\nimport Header from './components/Header'\nimport InfoTable from './components/InfoTable'\nimport SurveyChart from './components/SurveyChart'\nimport Footer from './components/Footer'\n\nconst LazyImageModal = lazy(() =\u003e import('./components/ImageModal'))\n\nfunction App() {\n    const [showModal, setShowModal] = useState(false)\n\n    return (\n        \u003cdiv className=\"App\"\u003e\n            \u003cHeader /\u003e\n            \u003cInfoTable /\u003e\n            \u003cButtonModal onClick={() =\u003e { setShowModal(true) }}\u003e올림픽 사진 보기\u003c/ButtonModal\u003e\n            \u003cSurveyChart /\u003e\n            \u003cFooter /\u003e\n            \u003cSuspense fallback={null}\u003e\n                {showModal ? \u003cLazyImageModal closeModal={() =\u003e { setShowModal(false) }} /\u003e : null}\n            \u003c/Suspense\u003e\n        \u003c/div\u003e\n    )\n}\n```\n\n#### Lazy Loading의 단점\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization12.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n우리가 모달을 클릭한순간 모달에 관련된 파일을 불러오고 JS를 Evaluate한다.\n\n이게 끝나고 실제로 모달을 띄우는 코드가 실행된다.\n\n최초 페이지에서는 성능이 조금 빨라졌지만 모달을 띄울 때는 오히려 성능이 더 느려졌다.\n\n#### **\\- 컴포넌트 Preload**\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization13.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n이를 개선하기 위해서 모달을 열기 이전에 모달과 관련된 코드를 미리 로드해 둔다.\n\n문제는 사용자가 모달을 언제 클릭할지 모르기 때문에 언제 미리 로드할지 애매하다.\n\n#### 타이밍\n\n1. 버튼 위에 마우스를 올려 놨을 때\n\n```js\nconst handleMouseEnter = () =\u003e {\n    const Component = import('./components/ImageModal')\n}\n\u003cButtonModal onClick={() =\u003e { setShowModal(true) }} onMouseEnter={handleMouseEnter}\u003e올림픽 사진 보기\u003c/ButtonModal\u003e\n```\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization14.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n2. 최초 페이지 로드가 되고, 모든 컴포넌트의 마운트가 끝났을 때(ComponentDidMount)\n\n\u003cimg src=\"/assets/blog/javaScript/web-optimization15.png\" width=\"100%\" alt=\"post image\"/\u003e\n\n```js\nuseEffect(() =\u003e {\n    const Component = import('./components/ImageModal')\n}, [])\n```\n\n지금은 단일 컴포넌트를 미리 import 하지만 여러 컴포넌트를 Preload해줘야 할 때는\n\n```js\nfunction lazyWithPreload(importFunction){\n    const Component = React.lazy(importFunction)\n    Component.preload = importFunction\n    return Component\n}\n\nconst LazyImageModal = lazyWithPreload(() =\u003e import('./components/ImageModal'))\n```\n\n```js\nuseEffect(() =\u003e {\n    LazyImageModal.preload()\n}, [])\n```\n\n처럼 사용할 수 있다.\n\n#### **\\- 이미지 Preload**\n\n**new Image()**\n\n```js\nuseEffect(() =\u003e {\n    LazyImageModal.preload()\n\n    const img = new Image()\n    img.src = 'url'\n}, [])\n```\n\n주의할점은 이미지는 모듈과 다르게 필요할 때 마다 그때그때 매번 보내기 때문에\n\n사용하는 이미지에 캐시가 제대로 걸려있는지 확인할 필요가 있다.\n"])</script><script>self.__next_f.push([1,"7:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/bee2c35e5d2aa945.css\",\"precedence\":\"next\"}]],[\"$\",\"$L8\",null,{\"buildId\":\"DblKLeN53OECqepoSp_fi\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/page/3\",\"initialTree\":[\"\",{\"children\":[\"page\",{\"children\":[[\"page\",\"3\",\"d\"],{\"children\":[\"__PAGE__?{\\\"page\\\":\\\"3\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L9\"],\"globalErrorComponent\":\"$a\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[null,[\"$\",\"$Lb\",null,{\"src\":\"https://www.googletagmanager.com/gtag/js?id=G-LFDRQZPCBN\"}],[\"$\",\"$Lb\",null,{\"id\":\"google-analytics\",\"children\":\"\\n          window.dataLayer = window.dataLayer || [];\\n          function gtag(){dataLayer.push(arguments);}\\n          gtag('js', new Date());\\n \\n          gtag('config', 'G-LFDRQZPCBN');\\n        \"}],[\"$\",\"body\",null,{\"suppressHydrationWarning\":true,\"className\":\"__className_471caf\",\"children\":[[\"$\",\"header\",null,{\"className\":\"sticky top-0 z-10 mx-auto my-0 h-[56px] border-b-[1px] border-b-gray200 bg-white px-[24px] py-0\",\"children\":[\"$\",\"section\",null,{\"className\":\"m-auto flex h-full max-w-[970px] items-center justify-between\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-[20px]\",\"children\":[[\"$\",\"$Lc\",null,{\"href\":\"/\",\"children\":[\"$\",\"$Ld\",null,{\"src\":\"/assets/icons/been-logo.svg\",\"width\":60,\"height\":56,\"alt\":\"logo\"}]}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-[20px]\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"/about\",\"children\":\"About\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"flex items-center gap-[20px]\",\"children\":[[\"$\",\"$Lc\",null,{\"href\":\"https://github.com/wonbeenna\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":[\"$\",\"$Ld\",null,{\"src\":\"/assets/icons/github.svg\",\"width\":30,\"height\":30,\"alt\":\"github\"}]}],[\"$\",\"$Lc\",null,{\"href\":\"mailto:nwbnwb@naver.com\",\"children\":[\"$\",\"$Ld\",null,{\"src\":\"/assets/icons/mail.svg\",\"width\":34,\"height\":34,\"alt\":\"email\"}]}]]}]]}]}],[\"$\",\"main\",null,{\"className\":\"mx-auto my-0 max-w-[970px] p-[16px]\",\"children\":[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"page\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Le\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"page\",\"children\",[\"page\",\"3\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lf\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$L10\",[\"$\",\"section\",null,{\"className\":\"flex flex-col-reverse md:relative md:flex-row\",\"children\":[[\"$\",\"$L11\",null,{\"posts\":{\"posts\":[{\"content\":\"$12\",\"data\":{\"title\":\"6주간 스터디하며 배운것들\",\"date\":\"$D2022-10-21T00:00:00.000Z\",\"description\":\"6주간 진행한 스터디에서 얻은 것들\",\"category\":\"til\",\"titleImage\":\"/assets/postIcon/til.webp\"},\"slug\":\"study\"},{\"content\":\"$13\",\"data\":{\"title\":\"Storybook 써보기\",\"date\":\"$D2022-10-11T00:00:00.000Z\",\"description\":\"스터디 하면서 처음 써본 Storybook\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/storybook.png\"},\"slug\":\"storybook\"},{\"content\":\"$14\",\"data\":{\"title\":\"Next.js styled-component 적용 문제에 대해(_document.tsx)\",\"date\":\"$D2022-08-22T00:00:00.000Z\",\"description\":\"next.js와 styled-component 사용시 발생한 에러\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/Nextjs.svg\"},\"slug\":\"next-styled-component\"},{\"content\":\"$15\",\"data\":{\"title\":\"IntersectionObserver로 데이터 요청해보기\",\"date\":\"$D2022-05-04T00:00:00.000Z\",\"description\":\"IntersectionObserver를 활용해 스크롤 위치에서 데이터 불러오기\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/logo192.png\"},\"slug\":\"intersectionObserver\"},{\"content\":\"\\n\\n####\\n**bundle-analyzer**는 빌드된 파일을 트리맵 형식으로 종류와 크기를 보여준다.\\n\\nnext에서 제공하는 bundle-analyzer\\n\\nnext.config.js\\n\\n```javascript\\nconst withBundleAnalyzer = require('@next/bundle-analyzer')({\\n  enabled: process.env.ANALYZE === 'true'\\n})\\n\\nmodule.exports = withBundleAnalyzer({\\n  compress: true,\\n  webpack(config, {webpack}) {\\n    const prod = process.env.NODE_ENV === 'production'\\n    const plugins = [...config.plugins]\\n    return {\\n      ...config,\\n      mode: prod ? 'production' : 'development',\\n      devtool: prod ? 'hidden-source-map' : 'eval',\\n      plugins\\n    }\\n  }\\n})\\n```\\n\\npackage.json / script\\n\\n```\\n\\\"build\\\": \\\"ANALYZE=true next build\\\",\\n```\\n\\n\u003cimg src=\\\"/assets/blog/javaScript/bundle-analyzer.png\\\" width=\\\"100%\\\" alt=\\\"bundle-analyzer\\\"/\u003e\\n\\n\\n이런식으로 html이 실행된다.\\n\\n서버와 클라이언트 두개의 창이 실행되는데 클라이언트 부분인 사용자에게 직접 보여질 부분이라, 서버 부분보다는 클라이언트 부분을 줄이는게 더 효과적이라고 한다.\\n\\n아이콘으로 쓰일 이미지를 두개쓰기싫어 svg를 컴포넌트화시켜 props로 색상을 변경시키게 했는데, 용량이 꽤 크다고 나왔다 거슬린다 🤔\\n\\n줄일수있는 방법을 찾아봐야겠다.\\n\\n또 나중에 최종 배포때는 번들된 JS 파일을 gz로 압축시켜 브라우저 쪽으로 보내주는 방법도 있다고 하는데, 나중에 시도해봐야겠다.\\n\",\"data\":{\"title\":\"next/bundle-analyzer\",\"date\":\"$D2022-02-22T00:00:00.000Z\",\"description\":\"next/bundle-analyzer로 번들 크기 확인하기\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/Nextjs.svg\"},\"slug\":\"next-bundle-analyzer\"},{\"content\":\"$16\",\"data\":{\"title\":\"리액트 ref 와 forwardRef (with. react-hook-form)\",\"date\":\"$D2022-02-09T00:00:00.000Z\",\"description\":\"react-hook-form 라이브러리와 ref의 동작\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/logo192.png\"},\"slug\":\"ref-forwardRef\"},{\"content\":\"$17\",\"data\":{\"title\":\"Speechsynthesis \u0026 Google TTS\",\"date\":\"$D2022-01-22T00:00:00.000Z\",\"description\":\"프로젝트 진행하며 경험해본 Speechsynthesis \u0026 Google TTS\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/logo192.png\"},\"slug\":\"Speechsynthesis\"},{\"content\":\"$18\",\"data\":{\"title\":\"웹성능 최적화(3)\",\"date\":\"$D2022-01-04T00:00:00.000Z\",\"description\":\"웹성능 최적화3\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/logo192.png\"},\"slug\":\"web-optimization-3\"},{\"content\":\"$19\",\"data\":{\"title\":\"웹성능 최적화(2)\",\"date\":\"$D2022-01-03T00:00:00.000Z\",\"description\":\"웹성능 최적화2\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/logo192.png\"},\"slug\":\"web-optimization-2\"},{\"content\":\"$1a\",\"data\":{\"title\":\"웹성능 최적화(1)\",\"date\":\"$D2022-01-01T00:00:00.000Z\",\"description\":\"웹성능 최적화1\",\"category\":\"javaScript\",\"titleImage\":\"/assets/postIcon/logo192.png\"},\"slug\":\"web-optimization\"}],\"total\":34},\"page\":\"3\",\"category\":\"$undefined\"}],[\"$\",\"ul\",null,{\"className\":\"relative top-0 flex h-fit min-w-fit flex-row flex-wrap gap-[20px] py-[20px] pl-0 md:sticky md:top-[100px] md:flex-col md:flex-nowrap md:py-0 md:pl-[30px]\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"hidden text-[18px] font-bold md:inline\",\"children\":\"Category\"}],[[\"$\",\"li\",\"javaScript\",{\"children\":[\"$\",\"$Lc\",null,{\"className\":\"text-gray700\",\"href\":\"/blog/javaScript\",\"children\":\"javaScript (31)\"}]}],[\"$\",\"li\",\"study\",{\"children\":[\"$\",\"$Lc\",null,{\"className\":\"text-gray700\",\"href\":\"/blog/study\",\"children\":\"study (2)\"}]}],[\"$\",\"li\",\"til\",{\"children\":[\"$\",\"$Lc\",null,{\"className\":\"text-gray700\",\"href\":\"/blog/til\",\"children\":\"til (1)\"}]}]]]}]]}],null],\"segment\":\"__PAGE__?{\\\"page\\\":\\\"3\\\"}\"},\"styles\":[]}],\"segment\":[\"page\",\"3\",\"d\"]},\"styles\":[]}],\"segment\":\"page\"},\"styles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"flex items-center justify-center pb-[16px] text-center text-[14px] text-gray600\",\"children\":\"Copyright © Been.\"}]]}]]}],null]}]]\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Been blog - 3\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Been dev-note\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"4\",{\"name\":\"google-site-verification\",\"content\":\"BirkRt7C7FYMLW96RbXad2EtPdcl0-_ti9xCRkCHa5U\"}],[\"$\",\"meta\",\"5\",{\"name\":\"naver-site-verification\",\"content\":\"58945b2bbe2fe86252fa8c7b204b40f6019920e9\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"Been blog - 3\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"Been dev-note - 3\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:url\",\"content\":\"https://wonbeenna.github.io/page/3\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:site_name\",\"content\":\"Been blog\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:image\",\"content\":\"https://wonbeenna.github.io/favicon.png\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image:width\",\"content\":\"800\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:image:height\",\"content\":\"600\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image:alt\",\"content\":\"Been blog\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:title\",\"content\":\"Been blog - 3\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:description\",\"content\":\"Been dev-note - 3\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:image\",\"content\":\"https://wonbeenna.github.io/favicon.png\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:image:width\",\"content\":\"800\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:image:height\",\"content\":\"600\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:image:alt\",\"content\":\"Been blog\"}],[\"$\",\"link\",\"22\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"192x192\"}],[\"$\",\"meta\",\"23\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"10:null\n"])</script></body></html>